<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>æ¶é›»ãƒŠãƒ“ | MIXEDæ ªå¼ä¼šç¤¾</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&family=M+PLUS+Rounded+1c:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a5fb4;
            --primary-light: #3584e4;
            --secondary: #e01b24;
            --accent-yellow: #f5c211;
            --accent-green: #26a269;
            --accent-purple: #9141ac;
            --bg-main: #f6f5f4;
            --bg-white: #ffffff;
            --text-dark: #241f31;
            --text-gray: #5e5c64;
            --border: #deddda;
            --shadow: rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: var(--bg-main);
            color: var(--text-dark);
            line-height: 1.7;
            font-size: 16px;
            min-height: 100vh;
        }

        /* ========== ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿è­·ç”»é¢ ========== */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a5fb4 0%, #3584e4 50%, #62a0ea 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .login-screen.hidden {
            display: none;
        }

        .login-box {
            background: white;
            padding: 2.5rem 2rem;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            width: 90%;
            max-width: 380px;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2.5rem;
            color: white;
            box-shadow: 0 8px 20px rgba(26, 95, 180, 0.3);
        }

        .login-company {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .login-title {
            font-size: 1rem;
            color: var(--text-gray);
            margin-bottom: 2rem;
        }

        .login-input-group {
            margin-bottom: 1rem;
        }

        .login-input {
            width: 100%;
            padding: 1rem;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 10px;
            outline: none;
            transition: border-color 0.3s, box-shadow 0.3s;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .login-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 95, 180, 0.1);
        }

        .login-input.error {
            border-color: var(--secondary);
            animation: shake 0.4s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            50% { transform: translateX(8px); }
            75% { transform: translateX(-8px); }
        }

        .login-btn {
            width: 100%;
            padding: 1rem;
            font-size: 1rem;
            font-weight: 700;
            color: white;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(26, 95, 180, 0.4);
        }

        .login-error {
            color: var(--secondary);
            font-size: 0.85rem;
            margin-top: 1rem;
            display: none;
        }

        .login-error.show {
            display: block;
        }

        .app-content {
            display: none;
        }

        .app-content.visible {
            display: block;
        }

        /* ========== ãƒ˜ãƒƒãƒ€ãƒ¼ ========== */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 1rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px var(--shadow);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .header h1 {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
        }

        /* ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆã‚¿ãƒ– */
        .page-tabs {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 0.5rem;
        }

        .page-tab {
            padding: 0.5rem 1rem;
            background: rgba(255,255,255,0.2);
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .page-tab:hover {
            background: rgba(255,255,255,0.3);
        }

        .page-tab.active {
            background: white;
            color: var(--primary);
        }

        /* ========== é€²æ—ãƒãƒ¼ ========== */
        .progress-container {
            background: var(--bg-white);
            padding: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
        }

        .step-label {
            font-weight: 700;
            color: var(--primary);
        }

        .step-remaining {
            font-size: 0.75rem;
            color: var(--text-gray);
            margin-left: 0.5rem;
        }

        .step-phase {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            margin-left: 0.5rem;
        }

        .step-phase.early {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .step-phase.mid {
            background: #fff3e0;
            color: #ef6c00;
        }

        .step-phase.late {
            background: #fce4ec;
            color: #c2185b;
        }

        .progress-bar {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent-green) 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* ========== ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ ========== */
        .main {
            max-width: 600px;
            margin: 0 auto;
            padding: 1rem;
            padding-bottom: 180px; /* ãƒ˜ãƒ«ãƒ—ã‚¨ãƒªã‚¢ + ãƒŠãƒ“ãƒãƒ¼ç”¨ */
        }

        /* ã‚¹ãƒ†ãƒƒãƒ—ã‚«ãƒ¼ãƒ‰ */
        .step-card {
            background: var(--bg-white);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 2px 15px var(--shadow);
            animation: stepFadeIn 0.35s ease-out;
        }

        @keyframes stepFadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-card.hidden {
            display: none;
        }

        /* ========== ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ˜ãƒ«ãƒ—ã‚¨ãƒªã‚¢ ========== */
        .floating-help {
            position: fixed;
            bottom: 80px;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(246,245,244,1) 0%, rgba(246,245,244,0.95) 100%);
            padding: 0.75rem 1rem;
            z-index: 98;
            border-top: 1px solid var(--border);
            display: none;
        }

        .floating-help.visible {
            display: block;
            animation: slideUpHelp 0.3s ease-out;
        }

        @keyframes slideUpHelp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .floating-help-title {
            font-size: 0.8rem;
            color: var(--text-gray);
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .floating-help-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
        }

        .step-title {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary);
        }

        /* ãƒˆãƒ¼ã‚¯è¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .talk-display {
            background: #f8f7f6;
            border-left: 4px solid var(--primary);
            padding: 1.2rem;
            margin: 1rem 0;
            border-radius: 0 12px 12px 0;
            font-size: 1.05rem;
            line-height: 1.9;
        }

        .talk-display .highlight {
            background: linear-gradient(transparent 60%, #fef08a 60%);
            font-weight: 500;
        }

        .talk-display.warning {
            border-left-color: var(--accent-yellow);
            background: #fffbeb;
        }

        .talk-display.tip {
            border-left-color: var(--accent-green);
            background: #f4fbf7;
        }

        .talk-note {
            font-size: 0.9rem;
            color: var(--text-gray);
            margin-top: 0.5rem;
        }

        /* é¸æŠè‚¢ãƒœã‚¿ãƒ³ */
        .choices {
            display: grid;
            gap: 0.75rem;
            margin: 1.5rem 0;
        }

        .choices.two-col {
            grid-template-columns: 1fr 1fr;
        }

        .choice-btn {
            padding: 1.2rem 1rem;
            background: var(--bg-white);
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-dark);
            cursor: pointer;
            transition: all 0.15s ease-out;
            text-align: center;
            font-family: 'Noto Sans JP', sans-serif;
            position: relative;
            overflow: hidden;
        }

        .choice-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(26, 95, 180, 0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
        }

        .choice-btn:hover {
            border-color: var(--primary);
            background: #f0f6ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .choice-btn:active {
            transform: scale(0.96) translateY(0);
            box-shadow: none;
        }

        .choice-btn:active::after {
            width: 200px;
            height: 200px;
        }

        .choice-btn.primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border: none;
        }

        .choice-btn.primary:hover {
            box-shadow: 0 4px 15px rgba(26, 95, 180, 0.4);
        }

        .choice-btn.success {
            background: linear-gradient(135deg, var(--accent-green) 0%, #2ec27e 100%);
            color: white;
            border: none;
        }

        .choice-btn.warning {
            background: linear-gradient(135deg, #e5a50a 0%, var(--accent-yellow) 100%);
            color: white;
            border: none;
        }

        .choice-btn.danger {
            background: linear-gradient(135deg, #c01c28 0%, var(--secondary) 100%);
            color: white;
            border: none;
        }

        .choice-btn .btn-sub {
            display: block;
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 0.3rem;
        }

        /* åˆ‡ã‚Šè¿”ã—ãƒ˜ãƒ«ãƒ—ã‚¨ãƒªã‚¢ */
        .help-area {
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px dashed var(--border);
        }

        .help-title {
            font-size: 0.9rem;
            color: var(--text-gray);
            margin-bottom: 0.75rem;
        }

        .help-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .help-btn {
            padding: 0.6rem 1rem;
            background: #fff5f5;
            border: 1px solid #ffe0e0;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--secondary);
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .help-btn:hover {
            background: #ffe0e0;
        }

        /* ========== ãƒ¢ãƒ¼ãƒ€ãƒ« ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: flex-end;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            cursor: pointer;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--bg-white);
            width: 100%;
            max-width: 600px;
            max-height: 85vh;
            border-radius: 20px 20px 0 0;
            overflow: hidden;
            transform: translateY(100%);
            transition: transform 0.3s ease-out;
            cursor: default;
            display: flex;
            flex-direction: column;
        }

        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .modal-header h3 {
            font-size: 1rem;
            font-weight: 700;
            flex: 1;
        }

        .modal-close {
            background: rgba(255,255,255,0.25);
            border: none;
            color: white;
            min-width: 44px;
            min-height: 44px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 1rem;
        }

        .modal-close:hover {
            background: rgba(255,255,255,0.4);
            transform: scale(1.1);
        }

        .modal-close:active {
            transform: scale(0.95);
        }

        .modal-body {
            padding: 1.5rem;
            overflow-y: auto;
            flex: 1;
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border);
            flex-shrink: 0;
            background: var(--bg-main);
        }

        .modal-close-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .modal-close-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(26, 95, 180, 0.4);
        }

        .modal-close-btn:active {
            transform: scale(0.98);
        }

        .modal-action-link {
            display: block;
            text-align: center;
            margin-top: 0.75rem;
            padding: 0.75rem;
            background: linear-gradient(135deg, var(--accent-green) 0%, #2ec27e 100%);
            color: white;
            text-decoration: none;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 700;
            cursor: pointer;
            border: none;
            width: 100%;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .modal-action-link:hover {
            box-shadow: 0 4px 15px rgba(38, 162, 105, 0.4);
        }

        .modal-talk {
            background: #f8f7f6;
            border-left: 4px solid var(--accent-green);
            padding: 1rem;
            border-radius: 0 8px 8px 0;
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        .modal-talk .highlight {
            background: linear-gradient(transparent 60%, #fef08a 60%);
            font-weight: 500;
        }

        .modal-note {
            font-size: 0.85rem;
            color: var(--text-gray);
            padding: 0.75rem;
            background: #fffbeb;
            border-radius: 8px;
            margin-top: 0.5rem;
        }

        /* ========== ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ ========== */
        .nav-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, var(--bg-white) 0%, var(--bg-white) 90%, rgba(255,255,255,0.9) 100%);
            border-top: 1px solid var(--border);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.75rem;
            z-index: 99;
            box-shadow: 0 -4px 20px var(--shadow);
        }

        .nav-btn {
            min-width: 120px;
            min-height: 52px;
            padding: 0.875rem 1.25rem;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .nav-btn.back {
            background: linear-gradient(135deg, #5e5c64 0%, #77767b 100%);
            color: white;
            flex: 1;
        }

        .nav-btn.back:hover {
            background: linear-gradient(135deg, #4a484d 0%, #5e5c64 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .nav-btn.back:disabled {
            background: var(--border);
            color: var(--text-gray);
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .nav-btn.forward {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            flex: 1;
        }

        .nav-btn.forward:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(26, 95, 180, 0.4);
        }

        .nav-btn.forward:disabled {
            background: var(--border);
            color: var(--text-gray);
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .nav-btn.reset {
            min-width: auto;
            padding: 0.75rem;
            background: rgba(224, 27, 36, 0.1);
            color: var(--secondary);
            font-size: 0.85rem;
            font-weight: 500;
        }

        .nav-btn.reset:hover {
            background: rgba(224, 27, 36, 0.2);
        }

        .btn-count {
            font-size: 0.75rem;
            opacity: 0.8;
            margin-left: 0.25rem;
        }

        @media (max-width: 400px) {
            .nav-btn {
                min-width: 90px;
                font-size: 1rem;
                padding: 0.75rem 1rem;
            }
            .nav-btn.reset {
                font-size: 0.75rem;
                padding: 0.5rem;
            }
        }

        /* ========== çµ‚äº†ç”»é¢ ========== */
        .end-screen {
            text-align: center;
            padding: 2rem 1rem;
        }

        .end-screen.success {
            background: linear-gradient(135deg, var(--accent-green) 0%, #2ec27e 100%);
            color: white;
            border-radius: 16px;
        }

        .end-screen .icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .end-screen h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .checklist {
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
            text-align: left;
        }

        .checklist-item {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .checklist-item:last-child {
            border-bottom: none;
        }

        .end-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1.5rem;
        }

        .end-btn {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .end-btn.primary {
            background: white;
            color: var(--accent-green);
        }

        .end-btn.secondary {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        /* ãƒˆãƒ¼ã‚¯ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ‡ã‚Šæ›¿ãˆ */
        .pattern-toggle {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .pattern-btn {
            flex: 1;
            padding: 0.5rem;
            background: var(--bg-main);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .pattern-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .pattern-content {
            display: none;
        }

        .pattern-content.active {
            display: block;
        }

        /* ã‚¹ãƒãƒ›å¯¾å¿œ */
        @media (max-width: 600px) {
            .header h1 {
                font-size: 1.1rem;
            }

            .choices.two-col {
                grid-template-columns: 1fr;
            }

            .choice-btn {
                padding: 1rem;
            }

            .login-box {
                padding: 2rem 1.5rem;
            }

            .login-logo {
                width: 70px;
                height: 70px;
                font-size: 2rem;
            }
        }

        /* ========== æ¶é›»ãƒ­ã‚°æ©Ÿèƒ½ ========== */
        .log-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 101;
            background: linear-gradient(135deg, var(--accent-purple) 0%, #c061cb 100%);
            color: white;
            border: none;
            padding: 0.6rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(145, 65, 172, 0.3);
            transition: all 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .log-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(145, 65, 172, 0.4);
        }

        .log-btn .badge {
            background: white;
            color: var(--accent-purple);
            padding: 0.1rem 0.4rem;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-left: 0.3rem;
        }

        /* æ¶é›»é–‹å§‹ãƒ•ã‚©ãƒ¼ãƒ  */
        .call-start-form {
            background: linear-gradient(135deg, #f0f6ff 0%, #e8f5e9 100%);
            border: 2px solid var(--primary-light);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .call-start-form h3 {
            color: var(--primary);
            font-size: 1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-row {
            margin-bottom: 1rem;
        }

        .form-row:last-child {
            margin-bottom: 0;
        }

        .form-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0.4rem;
        }

        .form-label .required {
            color: var(--secondary);
            margin-left: 0.25rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Noto Sans JP', sans-serif;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 95, 180, 0.1);
        }

        .form-row-inline {
            display: flex;
            gap: 0.5rem;
            align-items: flex-end;
        }

        .form-row-inline .form-input {
            flex: 1;
        }

        .form-btn-small {
            padding: 0.75rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .form-btn-small.add {
            background: var(--accent-green);
            color: white;
        }

        .form-btn-small.delete {
            background: var(--secondary);
            color: white;
        }

        /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ»ãƒ©ã‚¸ã‚ª */
        .form-checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .form-checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.5rem 0.75rem;
            background: white;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .form-checkbox-label:has(input:checked) {
            border-color: var(--primary);
            background: #f0f6ff;
        }

        .form-checkbox-label input {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        /* ãƒ­ã‚°ä¸€è¦§ãƒ¢ãƒ¼ãƒ€ãƒ« */
        .log-list-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .log-list-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .log-list-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 95%;
            max-width: 500px;
            max-height: 90vh;
            background: var(--bg-white);
            border-radius: 20px;
            overflow: hidden;
            transition: transform 0.3s;
            display: flex;
            flex-direction: column;
        }

        .log-list-modal.show .log-list-container {
            transform: translate(-50%, -50%) scale(1);
        }

        .log-list-header {
            background: linear-gradient(135deg, var(--accent-purple) 0%, #c061cb 100%);
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .log-list-header h3 {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .log-list-close {
            background: rgba(255,255,255,0.25);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.3rem;
            cursor: pointer;
        }

        .log-list-toolbar {
            padding: 0.75rem 1rem;
            background: var(--bg-main);
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .log-filter-select {
            padding: 0.5rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.85rem;
            background: white;
        }

        .log-list-body {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .log-item {
            background: white;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .log-item:hover {
            border-color: var(--primary);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .log-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .log-item-date {
            font-size: 0.8rem;
            color: var(--text-gray);
        }

        .log-item-result {
            font-size: 0.75rem;
            padding: 0.2rem 0.6rem;
            border-radius: 10px;
            font-weight: 700;
        }

        .log-item-result.success {
            background: #d3f9d8;
            color: #1b5e20;
        }

        .log-item-result.recall {
            background: #fff3e0;
            color: #ef6c00;
        }

        .log-item-result.not-target {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .log-item-company {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .log-item-caller {
            font-size: 0.85rem;
            color: var(--text-gray);
        }

        .log-list-footer {
            padding: 1rem;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .log-action-btn {
            flex: 1;
            min-width: 120px;
            padding: 0.75rem;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .log-action-btn.download {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }

        .log-action-btn.delete-all {
            background: rgba(224, 27, 36, 0.1);
            color: var(--secondary);
        }

        /* ãƒ­ã‚°è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« */
        .log-detail-content {
            padding: 1.5rem;
        }

        .log-detail-section {
            margin-bottom: 1.5rem;
        }

        .log-detail-section h4 {
            font-size: 0.9rem;
            color: var(--text-gray);
            margin-bottom: 0.5rem;
            padding-bottom: 0.25rem;
            border-bottom: 1px solid var(--border);
        }

        .log-detail-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            font-size: 0.95rem;
        }

        .log-detail-row .label {
            color: var(--text-gray);
        }

        .log-detail-row .value {
            font-weight: 500;
            text-align: right;
            max-width: 60%;
        }

        .log-detail-memo {
            background: var(--bg-main);
            padding: 0.75rem;
            border-radius: 8px;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .log-detail-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .log-detail-btn {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .log-detail-btn.image {
            background: linear-gradient(135deg, var(--accent-green) 0%, #2ec27e 100%);
            color: white;
        }

        .log-detail-btn.delete {
            background: rgba(224, 27, 36, 0.1);
            color: var(--secondary);
        }

        /* ç”»åƒå‡ºåŠ›ç”¨ã®ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒªã‚¢ï¼ˆéè¡¨ç¤ºï¼‰ */
        .log-capture {
            position: fixed;
            left: -9999px;
            top: 0;
            width: 400px;
            background: white;
            padding: 1.5rem;
            font-family: 'Noto Sans JP', sans-serif;
        }

        .log-capture-header {
            text-align: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--primary);
        }

        .log-capture-header h2 {
            color: var(--primary);
            font-size: 1.2rem;
        }

        .log-capture-header .date {
            color: var(--text-gray);
            font-size: 0.85rem;
        }

        .log-capture-body {
            font-size: 0.9rem;
        }

        .log-capture-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px dotted var(--border);
        }

        .log-capture-footer {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid var(--primary);
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-gray);
        }

        .empty-logs {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-gray);
        }

        .empty-logs .icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        @media (max-width: 600px) {
            .log-btn {
                padding: 0.5rem 0.75rem;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿è­·ç”»é¢ -->
    <div id="loginScreen" class="login-screen">
        <div class="login-box">
            <div class="login-logo">ğŸ¯</div>
            <div class="login-company">MIXEDæ ªå¼ä¼šç¤¾</div>
            <div class="login-title">æ¶é›»ãƒŠãƒ“</div>
            <div class="login-input-group">
                <input type="password" id="passwordInput" class="login-input" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›" autocomplete="off">
            </div>
            <button id="loginBtn" class="login-btn">ãƒ­ã‚°ã‚¤ãƒ³</button>
            <div id="loginError" class="login-error">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“</div>
        </div>
    </div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div id="appContent" class="app-content">
        <header class="header">
            <div class="header-top">
                <h1>ğŸ¯ æ¶é›»ãƒŠãƒ“</h1>
            </div>
            <div class="page-tabs">
                <a href="index.html" class="page-tab">ğŸ“– ãƒãƒ‹ãƒ¥ã‚¢ãƒ«</a>
                <a href="navi.html" class="page-tab active">ğŸ¯ æ¶é›»ãƒŠãƒ“</a>
            </div>
        </header>

        <div class="progress-container">
            <div class="progress-info">
                <span>
                    <span class="step-label" id="stepLabel">STEP 1 / 10</span>
                    <span class="step-phase early" id="stepPhase">åºç›¤</span>
                </span>
                <span id="stepName">å°å…¥ï¼ˆå—ä»˜çªç ´ï¼‰</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 10%"></div>
            </div>
        </div>

        <main class="main" id="mainContent">
            <!-- ã‚¹ãƒ†ãƒƒãƒ—ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
        </main>

        <!-- ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ˜ãƒ«ãƒ—ã‚¨ãƒªã‚¢ -->
        <div class="floating-help" id="floatingHelp">
            <div class="floating-help-title">ğŸ’¬ å›°ã£ãŸã‚‰ã‚¿ãƒƒãƒ—</div>
            <div class="floating-help-buttons" id="floatingHelpButtons">
                <!-- å‹•çš„ã«ç”Ÿæˆ -->
            </div>
        </div>

        <nav class="nav-bar">
            <button class="nav-btn back" id="backBtn" disabled>â† æˆ»ã‚‹</button>
            <button class="nav-btn reset" id="resetBtn">ğŸ”„ æœ€åˆã‹ã‚‰</button>
            <button class="nav-btn forward" id="forwardBtn" disabled>é€²ã‚€ â†’</button>
        </nav>
    </div>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">åˆ‡ã‚Šè¿”ã—ãƒˆãƒ¼ã‚¯</h3>
                <button class="modal-close" id="modalClose">Ã—</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- å‹•çš„ã«å†…å®¹ã‚’æŒ¿å…¥ -->
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn" id="modalCloseBtn">âœ“ é–‰ã˜ã‚‹</button>
                <button class="modal-action-link" id="modalActionBtn" style="display: none;">ğŸ‰ ã‚¢ãƒç²å¾—ã¸é€²ã‚€</button>
            </div>
        </div>
    </div>

    <!-- ãƒ­ã‚°ãƒœã‚¿ãƒ³ï¼ˆç”»é¢å³ä¸Šå›ºå®šï¼‰ -->
    <button class="log-btn" id="logBtn" style="display: none;">
        ğŸ“‹ ãƒ­ã‚°<span class="badge" id="logBadge">0</span>
    </button>

    <!-- ãƒ­ã‚°ä¸€è¦§ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="log-list-modal" id="logListModal">
        <div class="log-list-container">
            <div class="log-list-header">
                <h3>ğŸ“‹ æ¶é›»ãƒ­ã‚°ä¸€è¦§</h3>
                <button class="log-list-close" id="logListClose">Ã—</button>
            </div>
            <div class="log-list-toolbar">
                <select class="log-filter-select" id="logFilterCaller">
                    <option value="">å…¨ã¦ã®æ¶é›»è€…</option>
                </select>
                <select class="log-filter-select" id="logFilterResult">
                    <option value="">å…¨ã¦ã®çµæœ</option>
                    <option value="success">ã‚¢ãƒç²å¾—</option>
                    <option value="recall">å†æ¶é›»</option>
                    <option value="not-target">å¯¾è±¡å¤–</option>
                </select>
            </div>
            <div class="log-list-body" id="logListBody">
                <!-- ãƒ­ã‚°ä¸€è¦§ã¯JavaScriptã§å‹•çš„ç”Ÿæˆ -->
            </div>
            <div class="log-list-footer">
                <button class="log-action-btn download" id="logDownloadCsv">ğŸ“¥ CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                <button class="log-action-btn delete-all" id="logDeleteAll">ğŸ—‘ï¸ å…¨å‰Šé™¤</button>
            </div>
        </div>
    </div>

    <!-- ãƒ­ã‚°è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="log-list-modal" id="logDetailModal">
        <div class="log-list-container">
            <div class="log-list-header">
                <h3>ğŸ“„ ãƒ­ã‚°è©³ç´°</h3>
                <button class="log-list-close" id="logDetailClose">Ã—</button>
            </div>
            <div class="log-detail-content" id="logDetailContent">
                <!-- å‹•çš„ã«ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- ç”»åƒå‡ºåŠ›ç”¨ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒªã‚¢ -->
    <div class="log-capture" id="logCapture">
        <div class="log-capture-header">
            <h2>ğŸ“ æ¶é›»è¨˜éŒ²</h2>
            <div class="date" id="captureDate"></div>
        </div>
        <div class="log-capture-body" id="captureBody">
            <!-- å‹•çš„ã«ç”Ÿæˆ -->
        </div>
        <div class="log-capture-footer">
            MIXEDæ ªå¼ä¼šç¤¾ æ¶é›»ãƒŠãƒ“
        </div>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        // ========== ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ  ==========
        const STEPS = {
            'step1': {
                title: 'STEP 1: å°å…¥ï¼ˆå—ä»˜çªç ´ï¼‰',
                name: 'å°å…¥ï¼ˆå—ä»˜çªç ´ï¼‰',
                progress: 10,
                content: `
                    <div class="talk-display">
                        ãŠå¿™ã—ã„ã¨ã“ã‚æã‚Œå…¥ã‚Šã¾ã™ã€‚<br>
                        <span class="highlight">ã‚°ãƒ¼ã‚°ãƒ«ãƒãƒƒãƒ—æ’®å½±ä¼šç¤¾ ãƒŸãƒƒã‚¯ã‚¹ã®â—‹â—‹</span>ã§ã™ã€‚<br><br>
                        ã€‡ã€‡ï¼ˆä¼šç¤¾åï¼‰ã®<span class="highlight">ä»£è¡¨è€…æ§˜</span>ã¯ã„ã‚‰ã£ã—ã‚ƒã„ã¾ã™ã§ã—ã‚‡ã†ã‹ï¼Ÿ
                    </div>
                    <div class="talk-display warning">
                        <strong>âš ï¸ ã“ã“ã§ä¼šç¤¾åã‚’ã—ã£ã‹ã‚Šç¢ºèªã™ã‚‹</strong><br>
                        <span class="talk-note">é›»è©±å¸³ã®æƒ…å ±ã¨å®Ÿéš›ã®ä¼šç¤¾åãŒé•ã†å ´åˆãŒã‚ã‚Šã¾ã™</span>
                    </div>
                `,
                choices: [
                    { text: 'ä»£è¡¨è€…ã«ã¤ãªãŒã£ãŸ', sub: 'â†’ æ™‚é–“ç¢ºèªã¸', next: 'step2', class: 'primary' },
                    { text: 'ä¸åœ¨ã¨è¨€ã‚ã‚ŒãŸ', sub: 'â†’ å†æ¶é›»ç¢ºèª', next: 'step1b', class: '' },
                    { text: 'ä½•ã®ä»¶ï¼Ÿã¨èã‹ã‚ŒãŸ', sub: 'â†’ åˆ‡ã‚Šè¿”ã—è¡¨ç¤º', action: 'showHelp', helpId: 'whatCall', class: '' },
                    { text: 'å–¶æ¥­ã¯ã„ã‚‰ãªã„', sub: 'â†’ å†æ¶é›»ãƒªã‚¹ãƒˆã¸', next: 'endRecall', class: 'danger' }
                ],
                helps: [
                    { id: 'whatCall', label: 'ã€Œä½•ã®ä»¶ï¼Ÿã€', title: 'ã€Œï¼ˆå—ä»˜ï¼‰ä½•ã®ä»¶ã§ã—ã‚‡ã†ã‹ï¼Ÿã€ã¸ã®åˆ‡ã‚Šè¿”ã—', content: `
                        <div class="modal-talk">
                            <span class="highlight">ã‚°ãƒ¼ã‚°ãƒ«æ²è¼‰ã®ä»¶</span>ã«ãªã‚Šã¾ã™ã®ã§ã€ã”ä¸åœ¨ã§ã—ãŸã‚‰ã¾ãŸæ”¹ã‚ã¾ã™ã€‚å¤±ç¤¼ã„ãŸã—ã¾ã™ã€‚
                        </div>
                        <div class="modal-note">
                            â€»ãã‚Œã§ã‚‚ã—ã¤ã“ãèã„ã¦ãã‚‹å ´åˆ<br>
                            â†’ï¼ˆä¼æ¥­æƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ãªã‚Šã¾ã—ã¦ï¼‰ä»£è¡¨è€…æ§˜å®›ã®ä»¶ã«ãªã‚Šã¾ã™ã®ã§ã€æ€¥ãã§ã¯ãªã„ã®ã§ã¾ãŸæ”¹ã‚ã¾ã™ã€‚å¤±ç¤¼ã„ãŸã—ã¾ã™ã€‚
                        </div>
                    `},
                    { id: 'whatList', label: 'ã€Œä½•è¦‹ã¦ã‹ã‘ã¦ã‚‹ï¼Ÿã€', title: 'ã€Œä½•è¦‹ã¦ã‹ã‘ã¦ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã¸ã®åˆ‡ã‚Šè¿”ã—', content: `
                        <div class="modal-talk">
                            <span class="highlight">é›»å­é›»è©±å¸³ã‹ã‚‰é †ç•ªã«</span>ã”é€£çµ¡ã•ã›ã¦é ‚ã„ã¦ãŠã‚Šã¾ã™ã€‚
                        </div>
                        <div class="modal-note">
                            â€»ã€Œãƒªã‚¹ãƒˆã€ã¨è¨€ã†ã®ã¯NGï¼<br>
                            â€»éæ²è¼‰ãƒªã‚¹ãƒˆã®å ´åˆï¼šã€Œå¸‚å¤–å±€ç•ªã‹ã‚‰é †ç•ªã«ã”é€£çµ¡ã•ã›ã¦é ‚ã„ã¦ãŠã‚Šã¾ã™ã€
                        </div>
                    `}
                ]
            },
            'step1b': {
                title: 'STEP 1-B: ä¸åœ¨å¯¾å¿œ',
                name: 'ä¸åœ¨å¯¾å¿œ',
                progress: 10,
                content: `
                    <div class="talk-display">
                        ã‚°ãƒ¼ã‚°ãƒ«æ²è¼‰ã®ä»¶ã§ã®ã”é€£çµ¡ã«ãªã‚Šã¾ã™ãŒ<br>
                        <span class="highlight">ãŠæ˜¼ã‹å¤•æ–¹é ƒ</span>ã«ã¯æˆ»ã‚‰ã‚Œã¾ã™ã‹ï¼Ÿ
                    </div>
                    <div class="talk-display warning">
                        <span class="talk-note">â€»äºŒè€…æŠä¸€ã§èãï¼ˆã‚ªãƒ¼ãƒ—ãƒ³ã«èã‹ãªã„ï¼‰</span>
                    </div>
                `,
                choices: [
                    { text: 'æ™‚é–“ã‚’æ•™ãˆã¦ãã‚ŒãŸ', sub: 'â†’ å†æ¶é›»äºˆç´„', next: 'endRecallScheduled', class: 'success' },
                    { text: 'ã‚ã‹ã‚‰ãªã„/æ•™ãˆã¦ãã‚Œãªã„', sub: 'â†’ çµ‚äº†', next: 'endRecall', class: '' }
                ],
                helps: []
            },
            'step2': {
                title: 'STEP 2: æ™‚é–“ç¢ºèª',
                name: 'æ™‚é–“ç¢ºèª',
                progress: 20,
                content: `
                    <div class="talk-display">
                        Googleãƒãƒƒãƒ—ã®ãŠå†™çœŸã®ä»¶ã§ãŠé›»è©±ã•ã›ã¦ã„ãŸã ã„ãŸã®ã§ã™ãŒã€<br>
                        <span class="highlight">åªä»ŠãŠæ™‚é–“å°‘ã—å¤§ä¸ˆå¤«ã§ã—ã‚‡ã†ã‹ï¼Ÿ</span>
                    </div>
                `,
                choices: [
                    { text: 'å¤§ä¸ˆå¤«/ã©ã†ã', sub: 'â†’ Googleæ¡ˆå†…ã¸', next: 'step3', class: 'primary' },
                    { text: 'ä»Šå¿™ã—ã„', sub: 'â†’ æ™‚é–“ç¢ºèª', action: 'showHelp', helpId: 'busy', class: '' }
                ],
                helps: [
                    { id: 'busy', label: 'ã€Œä»Šå¿™ã—ã„ã€', title: 'ã€Œä»Šå¿™ã—ã„ã€ã¸ã®å¯¾å¿œ', content: `
                        <div class="modal-talk">
                            ãŠå¿™ã—ã„ã¨ã“ã‚å¤±ç¤¼ã„ãŸã—ã¾ã—ãŸã€‚<br>
                            æ”¹ã‚ã¦ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ããŸã„ã®ã§ã™ãŒã€<br>
                            <span class="highlight">æœ¬æ—¥ã®å¤•æ–¹ã‹ã€æ˜æ—¥</span>ã®ã”éƒ½åˆã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ
                        </div>
                        <div class="modal-note">â†’ æ™‚é–“ã‚’ç¢ºèªã—ã¦å†æ¶é›»äºˆç´„ã¸</div>
                    `}
                ]
            },
            'step3': {
                title: 'STEP 3: Googleæ’®å½±æ¡ˆå†…',
                name: 'Googleæ’®å½±æ¡ˆå†…',
                progress: 30,
                content: `
                    <div class="talk-display">
                        ä»Šã‚°ãƒ¼ã‚°ãƒ«ãƒãƒƒãƒ—ã«æ²è¼‰ã™ã‚‹äº‹æ¥­æ‰€ã®å†™çœŸã‚’<br>
                        é †ã€…ã«æ’®å½±ã—ã¦ãŠã‚Šã¾ã—ã¦ã€ã‚‚ã¡ã‚ã‚“<span class="highlight">ç„¡æ–™</span>ãªã®ã§ã™ãŒã€<br>
                        é€šå¸¸é€šã‚Š <span class="highlight">çœ‹æ¿ã‚„å¤–è¦³ã ã‘</span> ã®æ’®å½±ã§ã‚ˆã‚ã—ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ<br><br>
                        ï¼ˆå†…è¦³ã‚‚å¸Œæœ›ã•ã‚Œã¾ã™ã‹ï¼Ÿï¼‰
                    </div>
                `,
                choices: [
                    { text: 'å¤–è¦³ã ã‘ã§OK', sub: 'â†’ é›»æ°—æ¡ˆå†…ã¸', next: 'step4', class: 'primary' },
                    { text: 'ä¸­ã‚‚æ’®ã£ã¦ã»ã—ã„', sub: 'â†’ é›»æ°—æ¡ˆå†…ã¸', next: 'step4', class: 'success' },
                    { text: 'Googleã¯ã„ã‚‰ãªã„ã‚ˆ', sub: 'â†’ åˆ¥ææ¡ˆã¸', next: 'step3b', class: '' },
                    { text: 'ãã‚Œä½•ï¼Ÿè©³ã—ã', sub: 'â†’ èª¬æ˜è¡¨ç¤º', action: 'showHelp', helpId: 'whatGoogle', class: '' }
                ],
                helps: [
                    { id: 'whatGoogle', label: 'ã€Œã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ã¨é•ã†ã®ï¼Ÿã€', title: 'ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ã¨ã®é•ã„', content: `
                        <div class="modal-talk">
                            <strong>ã€ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ã€‘</strong><br>
                            ä»Šã€åœ°å›³ã®æ¨ªã«å»ºç‰©ã®ç›®å°ã¨ã—ã¦ãŠå†™çœŸãŒè¼‰ã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€ãã¡ã‚‰ã¯è»Šã«ã‚ˆã‚‹é€šã‚Šã™ãŒã‚Šã®è‡ªå‹•æ’®å½±ã¨ãªã‚Šã¾ã™ã€‚<br><br>
                            <strong>ã€ã‚¤ãƒ³ãƒ‰ã‚¢ãƒ“ãƒ¥ãƒ¼ï¼ˆä»Šå›ï¼‰ã€‘</strong><br>
                            ä»Šå›ã¯ä»£è¡¨è€…æ§˜ãŠç«‹ã¡åˆã„ã®å…ƒã€ãŠå¥½ããªç®‡æ‰€ã‚„è§’åº¦ã‹ã‚‰<span class="highlight">æœ€å¤§8ã‚«ãƒƒãƒˆã¾ã§</span>ãŠæ’®ã‚Šã•ã›ã¦ã„ãŸã ã‘ã¾ã™â™ª
                        </div>
                    `},
                    { id: 'whoAreYou', label: 'ã€ŒãŠãŸãã‚‰ä½•è€…ï¼Ÿã€', title: 'ã€ŒãŠãŸãã‚‰ä½•è€…ãªã‚“ï¼Ÿã€ã¸ã®åˆ‡ã‚Šè¿”ã—', content: `
                        <div class="modal-talk">
                            <span class="highlight">ã‚°ãƒ¼ã‚°ãƒ«èªå®šã®ã‚«ãƒ¡ãƒ©ãƒãƒ³ãŒåœ¨ç±ã—ã¦ã„ã‚‹æ’®å½±ä¼šç¤¾</span>ã§ã™ã€‚
                        </div>
                    `}
                ]
            },
            'step3b': {
                title: 'STEP 3-B: åˆ¥ææ¡ˆï¼ˆé›»æ°—ãƒ»ãƒãƒƒãƒˆï¼‰',
                name: 'Googleä¸è¦æ™‚ã®ææ¡ˆ',
                progress: 30,
                content: `
                    <div class="talk-display">
                        ã“ã¡ã‚‰ã®ã»ã‹ã«ã‚‚å¼Šç¤¾ã•ã¾ã–ã¾ãªã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¸­ã§ã—ã¦ã€<br>
                        <span class="highlight">é›»åŠ›ä¼šç¤¾ã•ã‚“ã¨é€šä¿¡ä¼šç¤¾ã•ã‚“ã«ã”å”è³›</span>ã„ãŸã ã„ã¦ã„ã‚‹ä¸­ã§<br>
                        é›»æ°— ã¾ãŸã¯ ãŠé›»è©±å›ç·šï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆï¼‰ã®<br>
                        <span class="highlight">äº‹æ¥­æ‰€å‰²å¼•ã®ç„¡æ–™è¨ºæ–­</span>å—ã‘ã¦ã„ãŸã ã‘ã‚‹ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã®ã”ç”¨æ„ã‚‚ã”ã–ã„ã¾ã™(^^)<br><br>
                        æ–™é‡‘ã‚’ãã¡ã‚“ã¨ã”èª¬æ˜ã•ã›ã¦ã„ãŸã ãã¾ã—ã¦ã€<br>
                        ãŠå®‰ããªã£ã¦ã”ç´å¾—ã„ãŸã ã‘ãŸå ´åˆã«ã¯ã€<br>
                        <span class="highlight">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒãƒƒã‚¯ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ</span>ã‚‚ã”ã–ã„ã¾ã™â™ª
                    </div>
                `,
                choices: [
                    { text: 'èˆˆå‘³ã‚ã‚‹/èã„ã¦ã¿ã‚‹', sub: 'â†’ é›»åŠ›åˆ¤åˆ¥ã¸', next: 'step5', class: 'primary' },
                    { text: 'ãã‚Œã‚‚ã„ã‚‰ãªã„', sub: 'â†’ çµ‚äº†', next: 'endNotTarget', class: 'danger' },
                    { text: 'CBã„ãã‚‰ã‚‚ã‚‰ãˆã‚‹ï¼Ÿ', sub: 'â†’ åˆ‡ã‚Šè¿”ã—è¡¨ç¤º', action: 'showHelp', helpId: 'cashback', class: '' }
                ],
                helps: [
                    { id: 'cashback', label: 'ã€ŒCBã„ãã‚‰ï¼Ÿã€', title: 'ã€Œã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒãƒƒã‚¯ã„ãã‚‰ã‚‚ã‚‰ãˆã‚‹ï¼Ÿã€', content: `
                        <div class="modal-talk">
                            ã”åˆ©ç”¨çŠ¶æ³ã‚„æœˆã€…ã®ä½¿ç”¨é‡ã«ã‚ˆã£ã¦å¤‰ã‚ã£ã¦ãã¾ã™ãŒãƒ»ãƒ»ãƒ»<br>
                            <span class="highlight">1ä¸‡5åƒå††ï½æœ€å¤§7ä¸‡å††ãã‚‰ã„</span>ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒãƒƒã‚¯ã‚’å—ã‘ã‚‰ã‚Œã¦ã„ã‚‹ãŠå®¢æ§˜ãŒå¤šã„ã§ã™ã‚ˆâ™ª<br><br>
                            é›»æ°—ãƒãƒƒãƒˆã¨ã‚‚ã«ã€å®Ÿéš›åˆ‡ã‚Šæ›¿ãˆã‚‹ã¨ä»Šã‚ˆã‚Šã©ã‚Œãã‚‰ã„ãŠå®‰ããªã‚‹ã‹ã€CBã¯ã„ãã‚‰ã‚‚ã‚‰ãˆã‚‹ã®ã‹ã£ã¦ã„ã†ã¨ã“ã‚ã‚’è©³ã—ãã”èª¬æ˜ã•ã›ã¦ã„ãŸã ããŸã„ã®ã§ã€<span class="highlight">æ˜ç´°ã‚’ã”æº–å‚™ã„ãŸã ãã€è¨ªå•ã®ãŠæ™‚é–“ã‚’ä½œã£ã¦ã„ãŸã ã‘ãŸã‚‰</span>ã¨æ€ã„ã¾ã™(*^^*)
                        </div>
                    `}
                ]
            },
            'step4': {
                title: 'STEP 4: é›»æ°—ãƒ»ãƒãƒƒãƒˆè¦‹ç©ã‚‚ã‚Šèª˜å°',
                name: 'é›»æ°—ãƒ»ãƒãƒƒãƒˆæ¡ˆå†…',
                progress: 40,
                content: `
                    <div class="pattern-toggle">
                        <button class="pattern-btn active" onclick="showPattern(1)">ãƒ‘ã‚¿ãƒ¼ãƒ³â‘  ã‚·ãƒ³ãƒ—ãƒ«</button>
                        <button class="pattern-btn" onclick="showPattern(2)">ãƒ‘ã‚¿ãƒ¼ãƒ³â‘¡ è©³ç´°</button>
                    </div>
                    <div class="pattern-content active" id="pattern1">
                        <div class="talk-display">
                            æ’®å½±ã¯ã‚°ãƒ¼ã‚°ãƒ«èªå®šã®ã‚«ãƒ¡ãƒ©ãƒãƒ³ãŒãŠä¼ºã„ã™ã‚‹ã‚“ã§ã™ãŒã€<br>
                            ä»Šå›ã¯<span class="highlight">è²»ç”¨ã‹ã‹ã‚‰ãªã„ã”æ¡ˆå†…</span>ã§ã—ã¦ã€<br><br>
                            çš†ã•ã‚“ã«æ’®å½±ã®éš›ã«ä¸€ç‚¹ã ã‘ã„ã£ã—ã‚‡ã«ãŠä¼ãˆã—ã¦ãŸã®ãŒã€<br>
                            ä»Šã™ã”ãé«˜ããªã£ã¦ã‚‹é›»æ°—ã®<span class="highlight">é›»æ°—ä»£æ”¯æ´ã®è¦‹ç©ã ã‘</span><br>
                            é›»åŠ›ä¼šç¤¾ã•ã‚“ã¨å”åŠ›ã—ã¦ãŠå‡ºã—ã—ã¦ãŸã‚“ã§ã™ã­ï¼
                        </div>
                    </div>
                    <div class="pattern-content" id="pattern2">
                        <div class="talk-display">
                            æ’®å½±ã¯ã‚°ãƒ¼ã‚°ãƒ«èªå®šã®ã‚«ãƒ¡ãƒ©ãƒãƒ³ãŒãŠä¼ºã„ã™ã‚‹ã‚“ã§ã™ãŒã€<br>
                            ä»Šå›ã“ã¡ã‚‰ã®ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è‡ªä½“ãŒã€<span class="highlight">é›»åŠ›ä¼šç¤¾ã•ã‚“ã¨é€šä¿¡ä¼šç¤¾ã•ã‚“ã¨å”åŠ›ã—ã¦ã®</span>ã”æ¡ˆå†…ã«ãªã‚Šã¾ã™ã®ã§<br>
                            è²»ç”¨ã¯<span class="highlight">1å††ã‚‚ã‹ã‹ã‚‰ãªã„</span>ã§ã™â™ª<br><br>
                            ãã“ã§ ã¿ãªã•ã¾ã«ä¸€ç‚¹ã ã‘ã”å”åŠ›ã„ãŸã ããŸã„ã®ãŒã€<br>
                            æ’®å½±ã§ãŠä¼ºã„ã—ãŸéš›ã«é›»æ°—æ–™é‡‘ or ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆï¼ˆãŠé›»è©±å›ç·šï¼‰ã®<br>
                            <span class="highlight">"è¤‡æ•°ç¤¾"ç„¡æ–™è¦‹ç©ã‚‚ã‚Š</span> ã‚’å–ã‚‰ã›ã¦ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™ï¼
                        </div>
                    </div>
                    <div class="talk-display warning">
                        <strong>âš ï¸ ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§æ±ºè£ç¢ºèªã‚’ã™ã‚‹</strong><br>
                        <span class="talk-note">ã€Œé›»æ°—ã‚„ãƒãƒƒãƒˆã®å¥‘ç´„å¤‰æ›´ã¯ã”è‡ªèº«ã§ã”åˆ¤æ–­ã§ãã¾ã™ã‹ï¼Ÿã€</span>
                    </div>
                `,
                choices: [
                    { text: 'ã‚ã‹ã£ãŸ/é€²ã‚ã¦', sub: 'â†’ ãƒãƒƒãƒˆç¢ºèªã¸', next: 'step4b', class: 'primary' },
                    { text: 'ãªã‚“ã§é›»æ°—ï¼Ÿ', sub: 'â†’ åˆ‡ã‚Šè¿”ã—è¡¨ç¤º', action: 'showHelp', helpId: 'whyElectric', class: '' },
                    { text: 'æ±ºè£æ¨©ãŒãªã„', sub: 'â†’ æ±ºè£è€…ç¢ºèª', action: 'showHelp', helpId: 'noAuth', class: '' },
                    { text: 'çµå±€é›»æ°—ã®å–¶æ¥­ã§ã—ã‚‡ï¼Ÿ', sub: 'â†’ åˆ‡ã‚Šè¿”ã—è¡¨ç¤º', action: 'showHelp', helpId: 'justElectric', class: '' }
                ],
                helps: [
                    { id: 'whyElectric', label: 'ã€Œãªã‚“ã§é›»æ°—ï¼Ÿã€', title: 'ã€Œãªã‚“ã§é›»æ°—ã®è©±ãªã®ï¼Ÿã€ã¸ã®åˆ‡ã‚Šè¿”ã—', content: `
                        <div class="modal-talk">
                            ä»Šå›ã®æ’®å½±ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è‡ªä½“ãŒã€<span class="highlight">é›»åŠ›ä¼šç¤¾ã•ã‚“ã¨é€šä¿¡ä¼šç¤¾ã•ã‚“ã¨å”åŠ›ã—ã¦</span>ã”æ¡ˆå†…ã•ã›ã¦ã„ãŸã ã„ã¦ã„ã‚‹ã‚‚ã®ã§ã—ã¦ã€çš†ã•ã¾ã«<span class="highlight">é›»æ°—ä»£ã®ç„¡æ–™è¦‹ç©ã‚Š</span>ã‚’å–ã‚‰ã›ã¦ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™ã€‚<br><br>
                            ãã‚Œã«ã‚ˆã£ã¦æ’®å½±è²»ç”¨ã‚’<span class="highlight">å®Œå…¨ç„¡æ–™</span>ã§ã”æä¾›ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ãŠã‚Šã¾ã™â™ª
                        </div>
                        <div class="modal-note">
                            ãƒã‚¤ãƒ³ãƒˆï¼šæ’®å½±ã‚’ç„¡æ–™ã«ã™ã‚‹ãŸã‚ã®å”è³›ã¨ã„ã†å½¢ã§èª¬æ˜ã™ã‚‹
                        </div>
                    `},
                    { id: 'noAuth', label: 'ã€Œæ±ºè£æ¨©ãŒãªã„ã€', title: 'ã€Œæ±ºè£æ¨©ãŒãªã„ã€ã¸ã®å¯¾å¿œ', content: `
                        <div class="modal-talk">
                            ã¡ãªã¿ã«ã€é›»æ°—ã‚„ãƒãƒƒãƒˆã®ã”å¥‘ç´„ã¯<span class="highlight">ã©ãªãŸãŒã”åˆ¤æ–­</span>ã•ã‚Œã¾ã™ã‹ï¼Ÿ<br><br>
                            ï¼ˆã‚ªãƒ¼ãƒŠãƒ¼æ§˜/ç¤¾é•·æ§˜/æœ¬éƒ¨ãªã©ï¼‰<br><br>
                            ãã®æ–¹ã¯æœ¬æ—¥ã„ã‚‰ã£ã—ã‚ƒã„ã¾ã™ã‹ï¼Ÿã¾ãŸã¯ã€ãŠé›»è©±ã§ç¢ºèªã„ãŸã ãã“ã¨ã¯å¯èƒ½ã§ã—ã‚‡ã†ã‹ï¼Ÿ
                        </div>
                        <div class="modal-note">
                            ãƒ»æ±ºè£è€…ãŒåˆ¥ã«ã„ã‚‹å ´åˆ â†’ ãã®æ–¹ã«ç¹‹ã„ã§ã‚‚ã‚‰ã† or å†æ¶é›»äºˆç´„<br>
                            ãƒ»æœ¬éƒ¨æ±ºè£ã®å ´åˆ â†’ ã€Œæœ¬éƒ¨æ§˜ã¸ã®ç¢ºèªã®ä»•æ–¹ã‚’ãŠä¼ãˆã—ã¾ã™ã­ã€
                        </div>
                    `},
                    { id: 'justElectric', label: 'ã€Œçµå±€é›»æ°—ã§ã—ã‚‡ï¼Ÿã€', title: 'ã€Œçµå±€ç›®çš„ã¯é›»æ°—ã§ã—ã‚‡ï¼Ÿã€', content: `
                        <div class="modal-talk">
                            ã„ãˆã„ãˆ(æ„Ÿã˜è‰¯ã)ã€ç§å…±ã¯<span class="highlight">æ’®å½±ä¼šç¤¾</span>ãªã®ã§ã€æ’®å½±ã‚’ã•ã›ã¦ã„ãŸã ããŸã„ã‚“ã§ã™ãŒã€æ’®å½±è‡ªä½“ãŒé€šå¸¸ã¯è²»ç”¨ãŒã‹ã‹ã‚‹ã‚‚ã®ã ã£ãŸã®ã§ã€ãŠå®¢æ§˜ã‹ã‚‰ã™ã‚‹ã¨ã€Œãƒªã‚¹ã‚¯ã ã€ã¨ã„ã†ãŠå£°ãŒæ²¢å±±ã‚ã£ãŸã‚“ã§ã™ã­ã€‚<br><br>
                            ãªã®ã§ãŠå®¢æ§˜ã«ã¯ä¸€åˆ‡è²»ç”¨ãŒã‹ã‹ã‚‰ãªã„ã‚ˆã†ã«<span class="highlight">é›»æ°—ã®ä¼šç¤¾ã•ã‚“ã¨å”åŠ›ã—ã¦ã”æ¡ˆå†…</span>ã‚’ã•ã›ã¦ã„ãŸã ã„ã¦ã‚‹ã‚“ã§ã™ã­ã€‚
                        </div>
                        <div class="modal-note">
                            Q.ã€Œãªã‚“ã§ãã‚“ãªã“ã¨ã§ãã‚‹ã®ï¼Ÿã€<br>
                            A. ç§ã©ã‚‚ã¯<span class="highlight">ç´¹ä»‹æ–™ã‚’é›»åŠ›ä¼šç¤¾ã•ã‚“ã‚„é€šä¿¡ä¼šç¤¾ã•ã‚“ã‹ã‚‰é ‚ã„ã¦</span>ã¾ã—ã¦ã€ãã¡ã‚‰ã‚’ã‚°ãƒ¼ã‚°ãƒ«æ’®å½±ã«å……ã¦ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ã€è²»ç”¨ã‚’æ›ã‘ãšã«æ’®å½±ãŒå‡ºæ¥ã‚‹ã‚ˆã†ã«ãªã£ã¦ãŠã‚Šã¾ã™â˜†
                        </div>
                    `},
                    { id: 'cameraElectric', label: 'ã€Œã‚«ãƒ¡ãƒ©ãƒãƒ³ãŒé›»æ°—èª¬æ˜ï¼Ÿã€', title: 'ã€Œã‚«ãƒ¡ãƒ©ãƒãƒ³ãŒé›»æ°—ã‚„ãƒãƒƒãƒˆã®èª¬æ˜ã‚’ã™ã‚‹ã®ï¼Ÿã€', content: `
                        <div class="modal-talk">
                            ãŠã£ã—ã‚ƒã‚‹é€šã‚Šã§ã™ï¼<br>
                            <span class="highlight">ã‚¨ãƒªã‚¢æ‹…å½“1å</span>ãŒãŠä¼ºã„ã•ã›ã¦ã„ãŸã ã„ã¦ã¾ã™ã€‚<br><br>
                            ã‚°ãƒ¼ã‚°ãƒ«èªå®šã®ã‚«ãƒ¡ãƒ©ãƒãƒ³ã§ã™ãŒ<span class="highlight">é›»åŠ›ä¼šç¤¾ã‚„é€šä¿¡ä¼šç¤¾ã®å–æ¬¡æ¥­å‹™ã‚‚ã•ã›ã¦ã„ãŸã ã„ã¦ã„ã‚‹</span>ã®ã§ã€ãã¡ã‚‰ã®éƒ¨åˆ†ã‚‚ã”èª¬æ˜ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚
                        </div>
                    `}
                ]
            },
            'step4b': {
                title: 'STEP 4-B: ãƒãƒƒãƒˆåˆ©ç”¨ç¢ºèª',
                name: 'ãƒãƒƒãƒˆåˆ©ç”¨ç¢ºèª',
                progress: 45,
                content: `
                    <div class="talk-display">
                        æ›´æ–°ã™ã‚‹ã“ã¨ã§äº‹æ¥­æ‰€æ§˜ã®æƒ…å ±ãŒæ­£ç¢ºã«æ²è¼‰ã•ã‚Œã¾ã™ã€‚<br>
                        <span class="highlight">ã¡ãªã¿ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã®ã”åˆ©ç”¨ã¯ã”ã–ã„ã¾ã™ã‹ï¼Ÿ</span>
                    </div>
                    <div class="talk-display tip">
                        <span class="talk-note">â€»åˆ©ç”¨ãªãã¦ã‚‚ã€ãƒãƒƒãƒˆå›ç·šã®å¥‘ç´„ãŒã‚ã‚‹ã‹å¦ã‹ãŒé‡è¦ï¼</span>
                    </div>
                `,
                choices: [
                    { text: 'ãƒãƒƒãƒˆä½¿ã£ã¦ã‚‹', sub: 'â†’ é›»åŠ›åˆ¤åˆ¥ã¸ï¼ˆé›»æ°—+ãƒãƒƒãƒˆï¼‰', next: 'step5', class: 'primary' },
                    { text: 'ãƒãƒƒãƒˆã¯ä½¿ã£ã¦ãªã„', sub: 'â†’ é›»åŠ›åˆ¤åˆ¥ã¸ï¼ˆé›»æ°—ã®ã¿ï¼‰', next: 'step5', class: '' }
                ],
                helps: []
            },
            'step5': {
                title: 'STEP 5: é›»åŠ›ä¼šç¤¾åˆ¤åˆ¥',
                name: 'é›»åŠ›ä¼šç¤¾åˆ¤åˆ¥',
                progress: 50,
                content: `
                    <div class="talk-display">
                        ã¡ãªã¿ã«ã€ä»£è¡¨è€…æ§˜ã®ã¨ã“ã‚ã¯<br>
                        <span class="highlight">é–¢è¥¿é›»åŠ›ä»¥å¤–ã®ã¨ã“ã‚ã§å‰²å¼•ã£ã¦å—ã‘ã‚‰ã‚Œã¦ã¾ã™ã‹ï¼Ÿ</span>
                    </div>
                `,
                choices: [
                    { text: 'é–¢è¥¿é›»åŠ›ã®ã¾ã¾', sub: 'â†’ é–¢é›»å‘ã‘ãƒ’ã‚¢ãƒªãƒ³ã‚°', next: 'step6a', class: 'primary' },
                    { text: 'ä»–ã®é›»åŠ›ä¼šç¤¾ã«å¤‰ãˆã¦ã‚‹', sub: 'â†’ æ–°é›»åŠ›å‘ã‘ãƒ’ã‚¢ãƒªãƒ³ã‚°', next: 'step6b', class: '' },
                    { text: 'ã‚ã‹ã‚‰ãªã„/è¦šãˆã¦ãªã„', sub: 'â†’ é–¢é›»å‘ã‘ã§é€²è¡Œ', next: 'step6a', class: '' }
                ],
                helps: []
            },
            'step6a': {
                title: 'STEP 6-A: é–¢è¥¿é›»åŠ›ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘',
                name: 'é–¢é›»å‘ã‘ãƒ’ã‚¢ãƒªãƒ³ã‚°',
                progress: 60,
                content: `
                    <div class="talk-display">
                        ãã†ã§ã™ã‚ˆã­ï¼ã ã£ãŸã‚‰ã¡ã‚‡ã†ã©ã‚ˆã‹ã£ãŸã§ã™ï¼<br>
                        ä»Šã€<span class="highlight">é–¢è¥¿é›»åŠ›ãŠä½¿ã„ã®æ–¹ã«ã”æ¡ˆå†…</span>ã§ã—ã¦ã€<br><br>
                        é›»æ°—æ–™é‡‘ã«é–¢ã—ã¾ã—ã¦ã¯ã€å»å¹´ã®å¤å ´ã‹ã‚‰é›»æ°—ä»£ãŒã‚ãŒã£ã¦ã„ã‚‹ãŸã‚ã€<br>
                        ã¡ã‚‡ã†ã©<span class="highlight">"å®‰ã„ã­ï¼"</span>ã¨ã”å®Ÿæ„Ÿã„ãŸã ã‘ã‚‹æ™‚æœŸãªã‚“ã§ã™ã­ï¼<br><br>
                        ã©ã®é›»åŠ›ä¼šç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚„ãƒ—ãƒ©ãƒ³ãŒå¾¡ç¤¾æ§˜ã«åˆã†ã‹ã€<br>
                        å¼Šç¤¾ã§ã¯<span class="highlight">è¤‡æ•°ç¤¾ã§æ¨ªä¸¦ã³ã«ã—ã¦æ–™é‡‘ã‚’æ¯”è¼ƒ</span>ã—ã¦ã„ãŸã ã‘ã¾ã—ã¦ï½
                    </div>
                    <div class="talk-display tip">
                        <strong>â“ ãƒ’ã‚¢ãƒªãƒ³ã‚°</strong><br>
                        2.3ç‚¹ã»ã©ç¢ºèªãªã®ã§ã™ãŒã€<br>
                        é›»æ°—ã®åˆ©ç”¨æ–™é‡‘ã¯ã€<span class="highlight">æ¯æœˆã ã„ãŸã„ãŠã„ãã‚‰ãã‚‰ã„ãŠæ”¯æ‰•ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ</span>
                    </div>
                `,
                choices: [
                    { text: '1ä¸‡å††ä»¥ä¸Š', sub: 'â†’ ã‚ªãƒ¼ãƒ«é›»åŒ–ç¢ºèª', next: 'step6c', class: 'primary' },
                    { text: '1ä¸‡å††ä»¥ä¸‹', sub: 'â†’ å‹•åŠ›ç¢ºèª', next: 'step6d', class: '' },
                    { text: '10ä¸‡å††ä»¥ä¸Š/ã‹ãªã‚Šé«˜ã„', sub: 'â†’ é«˜åœ§ç¢ºèª', next: 'step6e', class: 'warning' },
                    { text: 'ã‚ã‹ã‚‰ãªã„', sub: 'â†’ å½“ã¦è¾¼ã¿ãƒ’ã‚¢ãƒªãƒ³ã‚°', action: 'showHelp', helpId: 'guessPrice', class: '' }
                ],
                helps: [
                    { id: 'guessPrice', label: 'å½“ã¦è¾¼ã¿ãƒ’ã‚¢ãƒªãƒ³ã‚°', title: 'é›»æ°—ä»£ã‚’æŠŠæ¡ã—ã¦ã„ãªã„äººã¸ã®å½“ã¦è¾¼ã¿', content: `
                        <div class="modal-talk">
                            ã ã„ãŸã„ã§å¤§ä¸ˆå¤«ãªã®ã§ã™ãŒã€<br>
                            äº‹æ¥­æ‰€ã¯ä¸€èˆ¬å®¶åº­ãã‚‰ã„ã®æ•·åœ°ã®åºƒã•ã¯ã”ã–ã„ã¾ã™ã‹ï¼Ÿ<br>
                            ï¼ˆã¯ã„ or ãã‚Œã«è¿‘ã„ï¼‰<br><br>
                            ã‚ã¨ã‚„ã£ã±ã‚Šæœã‹ã‚‰å¤•æ–¹ãã‚‰ã„ã¾ã§é›»æ°—ã¤ã‘ãŸã‚Šã€<br>
                            å¤å ´å†¬å ´ã¯ã‚¨ã‚¢ã‚³ãƒ³ã‚’ä½¿ã„ã¾ã™ã‚ˆã­ï¼Ÿï¼ˆã¯ã„ï¼‰<br><br>
                            ã§ã‚ã‚Œã°ãƒ»ãƒ»ãƒ»ãƒ»<span class="highlight">1ä¸‡å††ã¯è¶…ãˆã‚‰ã‚Œã¦ã„ã‚‹</span>ã‹ã¨æ€ã„ã¾ã™ã®ã§å¤§ä¸ˆå¤«ã§ã™â™ª
                        </div>
                        <div class="modal-note">â†’ ç¢ºèªå¾Œã€ã€Œ1ä¸‡å††ä»¥ä¸Šã€ã‚’é¸æŠ</div>
                    `},
                    { id: 'neverChanged', label: 'ã€Œé–¢é›»ã‹ã‚‰å¤‰ãˆãŸã“ã¨ãªã„ã€', title: 'ã€Œãã‚‚ãã‚‚é–¢é›»ã‹ã‚‰æ›¿ãˆãŸã“ã¨ãŒãªã„ã€', content: `
                        <div class="modal-talk">
                            <strong>ã€ã‚¹ãƒãƒ¼ãƒˆãƒ¡ãƒ¼ã‚¿ãƒ¼ãƒˆãƒ¼ã‚¯ã€‘</strong><br><br>
                            ãã‚‚ãã‚‚å®‰ããªã‚‹ç†ç”±ã®éƒ¨åˆ†ã§ã™ãŒã€<br>
                            ç¾åœ¨ã¯é–¢è¥¿é›»åŠ›ãŒäº‹æ¥­æ‰€æ§˜ã®<span class="highlight">ãƒ¡ãƒ¼ã‚¿ãƒ¼äº¤æ›</span>ã‚’ã•ã›ã¦ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™ã®ã§ã€ãã®å ´ã«è¡Œã‹ãªãã¦ã‚‚ä½¿ç”¨é‡ã®ç¢ºèªãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ãŠã‚Šã¾ã—ã¦ã€ãã®å½±éŸ¿ã§<span class="highlight">æ¤œé‡å“¡ãŒã¾ã‚ã‚‹å¿…è¦ãŒãªããªã£ãŸåˆ†ã€äººä»¶è²»ãŒå¤§å¹…ã«å‰Šæ¸›</span>å‡ºæ¥ã¦ãŠã‚Šã¾ã™ã€‚<br><br>
                            ä»Šå›ã”æ¡ˆå†…ã—ã¦ã„ã‚‹ã®ã¯ã€ä»ŠãŠä½¿ã„ã®é–¢è¥¿é›»åŠ›ã•ã‚“ã®ç™ºé›»ãƒ»é€é›»ãªã©ã®é›»æ°—ã®ä¾›çµ¦ã‚„è¨­å‚™ã¯<span class="highlight">ãã®ã¾ã¾</span>ã§ã€<span class="highlight">æ˜ç´°ç™ºè¡Œã‚’æ‹…å½“ã™ã‚‹ä¼šç¤¾ãŒå¤‰ã‚ã‚‹</span>ã£ã¦ã ã‘ãªã‚“ã§ã™ã­ï¼
                        </div>
                    `},
                    { id: 'dontWantChange', label: 'ã€Œé›»æ°—å¤‰ã‚ã‚‹ãªã‚‰ã„ã‚‰ãªã„ã€', title: 'ã€Œã§ã‚“ãå¤‰ã‚ã‚‹ãªã‚‰ã„ã‚‰ãªã„ç³»ã€', content: `
                        <div class="modal-talk">
                            <span class="highlight">é›»æ°—ã¯å¤‰ã‚ã‚‰ãªã„</span>ã§ã™ã‚ˆï¼<br>
                            ä»Šå›ã”æ¡ˆå†…ã—ã¦ã„ã‚‹ã®ã¯ä»ŠãŠä½¿ã„é–¢è¥¿é›»åŠ›ã•ã‚“ã®ç™ºé›»ãƒ»é€é›»ãªã©ã®é›»æ°—ã®ä¾›çµ¦ã‚„è¨­å‚™ã¯ãã®ã¾ã¾ã§ã€ã€Œã‚¨ãƒãƒ‘ãƒ«ã€ã§<span class="highlight">å‰²å¼•ã‚’é©ç”¨ã™ã‚‹ã ã‘</span>ã§é›»æ°—ä»£æ”¯æ´ãŒå—ã‘ã‚‹ã“ã¨ãŒå‡ºæ¥ã‚‹ã‚“ã§ã™ï¼
                        </div>
                        <div class="modal-note">â€»ã‚¨ãƒãƒ‘ãƒ«ã£ã¦ãªã«ï¼Ÿ â†’ äº‹æ¥­æ‰€ç”¨ã®å‰²å¼•ã‚’ã—ã¦ã„ã‚‹æ–°é›»åŠ›ä¼šç¤¾ã§ã™ã€‚</div>
                    `},
                    { id: 'contractChange', label: 'ã€Œå¥‘ç´„å¤‰ã‚ã‚‹ã‚“ã§ã—ã‚‡ï¼Ÿã€', title: 'ã€Œå¥‘ç´„å¤‰ã‚ã‚‹ã‚“ã§ã—ã‚‡ï¼Ÿã€', content: `
                        <div class="modal-talk">
                            å¥‘ç´„ã¨ã„ã†ã‚ˆã‚Šã¯<span class="highlight">çª“å£</span>ã«ãªã‚‹ã‚“ã§ã™ã‘ã©ã‚‚ã€<br>
                            ã§ã‚“ãã¯ã€Œç™ºé›»ã€ã€Œé€é›»ã€ã€Œæ˜ç´°ç™ºè¡Œã€ã®å¤§ãã3ã¤ã®æ¥­å‹™ã«åˆ†ã‹ã‚Œã‚‹ã®ã§ã™ãŒç™ºé›»ã€é€é›»ã®æœ€ã‚‚å¤§äº‹ãªéƒ¨åˆ†ã¯é–¢è¥¿é›»åŠ›ä»¥å¤–å‡ºæ¥ãªã„ã®ã§ã€ã‚‚ã¡ã‚ã‚“ãã®ã¾ã¾ã§ä»Šå›ã¯<span class="highlight">æ˜ç´°ç™ºè¡Œã®çª“å£ã®éƒ¨åˆ†ã ã‘ã‚¨ãƒãƒ‘ãƒ«ãŒæ‹…å½“</span>ã™ã‚‹ã ã‘ã§é›»æ°—ä»£æ”¯æ´ã‚’å—ã‘ã¦ã„ãŸã ã‘ã¾ã™ï¼<br><br>
                            ã§ã™ã®ã§ãªã«ã‹ã‚ã£ãŸæ™‚ã®å¯¾å¿œã‚‚ä¾›çµ¦å¤‰ã‚ã‚‰ãªã„ã®ã§ã€é–¢è¥¿é›»åŠ›ã•ã‚“ã‹ã‚‰å¤‰ã‚ã‚Šã¾ã›ã‚“ã®ã§ã”å®‰å¿ƒãã ã•ã„ã€‚
                        </div>
                    `},
                    { id: 'middleman', label: 'ã€Œé–“ã«å…¥ã‚‹ã®å«Œã€', title: 'ã€Œãªã‚“ã‹é–“ã«å…¥ã‚‹ã‚“å«Œã‚„ã€', content: `
                        <div class="modal-talk">
                            ã‚ã£ï¼<span class="highlight">é–“ã«å…¥ã‚‹ã¨ã„ã†ã‚ˆã‚Šå½¹å‰²åˆ†æ‹…</span>ã¿ãŸã„ãªã‚‚ã®ã§ã—ã¦ã€é›»æ°—ã®ä¾›çµ¦ã¯ä»Šå¾Œã‚‚ãšã£ã¨é–¢é›»ã•ã‚“ãªã®ã§ã€é–¢é›»ã•ã‚“ã‹ã‚‰ç›´ã§é›»æ°—ãŒé€ã‚‰ã‚Œã¦ãã‚‹ã‚“ã§ã™ã­ï¼<br>
                            ãªã®ã§<span class="highlight">é–“ã«å…¥ã‚Šã‚ˆã†ãŒãªã„</span>ã‚“ã§ã™ã‚ˆï¼
                        </div>
                    `}
                ]
            },
            'step6b': {
                title: 'STEP 6-B: æ–°é›»åŠ›ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘',
                name: 'æ–°é›»åŠ›å‘ã‘ãƒ’ã‚¢ãƒªãƒ³ã‚°',
                progress: 60,
                content: `
                    <div class="talk-display">
                        ãã†ã§ã™ã‚ˆã­ï¼ã ã£ãŸã‚‰ã¡ã‚‡ã†ã©ã‚ˆã‹ã£ãŸã§ã™ï¼<br>
                        ä»Šå›ãã†ã„ã£ãŸæ–¹ãŒ<span class="highlight">é›»æ°—ä»£æ”¯æ´ã®å¯¾è±¡</span>ã§ã—ã¦ã€<br>
                        ã¡ãªã¿ã«ã©ã¡ã‚‰ã®ä¼šç¤¾ã•ã‚“ã§ã”åˆ©ç”¨ã§ã—ã‚‡ã†ã‹ï¼Ÿ
                    </div>
                `,
                choices: [
                    { text: 'ä¼šç¤¾åã‚’ç­”ãˆã¦ãã‚ŒãŸ', sub: 'â†’ ã‚ªãƒ¼ãƒ«é›»åŒ–ç¢ºèª', next: 'step6c', class: 'primary' },
                    { text: 'è¦šãˆã¦ãªã„/ã‚ã‹ã‚‰ãªã„', sub: 'â†’ ä¼šç¤¾åç¢ºèª', action: 'showHelp', helpId: 'confirmCompany', class: '' }
                ],
                helps: [
                    { id: 'confirmCompany', label: 'ä¼šç¤¾åç¢ºèª', title: 'ä¼šç¤¾åç¢ºèªãƒˆãƒ¼ã‚¯', content: `
                        <div class="modal-talk">
                            ã€Œãƒãƒ«ã‚¨ãƒã§ã‚“ãã€ã€ŒãŠãƒˆã‚¯ã§ã‚“ãã€ã€Œã‚¨ãƒ•ã‚¨ãƒã§ã‚“ãã€ã§ã¯ãªã‹ã£ãŸã§ã—ã‚‡ã†ã‹ï¼Ÿ
                        </div>
                        <div class="modal-note">â†’ ç¢ºèªã§ããŸã‚‰ã€Œä¼šç¤¾åã‚’ç­”ãˆã¦ãã‚ŒãŸã€ã‚’é¸æŠ</div>
                    `},
                    { id: 'backToKanden', label: 'ã€Œé–¢é›»ã«æˆ»ã—ãŸã€', title: 'ã€Œæ–°é›»åŠ›ã‹ã‚‰é–¢é›»ã«æˆ»ã—ãŸã€', content: `
                        <div class="modal-talk">
                            æ–°é›»åŠ›ãŒé«˜é¨°ã—ãŸå½±éŸ¿ã¨ã‹ã§é–¢é›»ã«æˆ»ã£ã¦ã„ã‚‹æ–¹ã‚‚å¤šã„ã®ã§ã™ãŒã€ä»Šã£ã¦é–¢é›»ã•ã‚“ã‚‚åŒæ§˜ã®<span class="highlight">ç‡ƒæ–™èª¿æ•´é¡ã®å€¤ä¸Šã’ã‚’ä¸Šé™ãªã—ã§</span>è¡Œã£ã¦ã¾ã™ã®ã§çµæœçš„ã«ã¾ãŸé›»æ°—ä»£ãŒã‚ãŒã£ã¦ã—ã¾ã£ã¦ã„ã‚‹çŠ¶æ…‹ãªã‚“ã§ã™ã­ã€‚<br><br>
                            ã§ã™ã®ã§ä»Šå›ã¯äº‹æ¥­æ‰€å‰²å¼•ã§é«˜é¨°ã®å½±éŸ¿ã‚’å—ã‘ã«ãã„ã‚ˆã†ã«ã€<span class="highlight">é›»æ°—ã®å˜ä¾¡ã‚’èª¿æ•´</span>ã•ã›ã¦ã„ãŸã ã‘ã¾ã™ã€‚
                        </div>
                    `},
                    { id: 'justChanged', label: 'ã€Œå¤‰ãˆãŸã°ã£ã‹ã‚Šã€', title: 'ã€Œå¤‰ãˆãŸã°ã£ã‹ã‚Šã ã‹ã‚‰ã€', content: `
                        <div class="modal-talk">
                            ãã†ã§ã™ã‚ˆã­ï¼æœ€è¿‘å¤‰ãˆã‚‰ã‚ŒãŸã‚“ã§ã™ã‹ã­ï¼Ÿï¼ˆã„ã¤ã§ã‚‚OKï¼‰<br>
                            ã ã£ãŸã‚‰å•é¡Œãªã„ã§ã™ã‚ˆï¼<br><br>
                            ä»ŠãŠä½¿ã„ã®â—‹â—‹ã§ã‚“ãã•ã‚“ã§<span class="highlight">é•ç´„é‡‘ãŒç™ºç”Ÿã—ãŸå ´åˆã‚‚ã€ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¸­ãªã®ã§å…¨é¡ã“ã¡ã‚‰ã§è² æ‹…</span>ã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã¾ã™ã®ã§ã”å®‰å¿ƒãã ã•ã„â˜†
                        </div>
                    `},
                    { id: 'friend', label: 'ã€ŒçŸ¥ã‚Šåˆã„ã§å¤‰ãˆãŸã€', title: 'ã€ŒçŸ¥ã‚Šåˆã„ã®ã¨ã“ã‚ã ã‹ã‚‰ãƒ»ä»˜ãåˆã„ã§å¤‰ãˆãŸã€', content: `
                        <div class="modal-talk">
                            ãã†ã§ã™ã‚ˆã­ï¼ãŠçŸ¥ã‚Šåˆã„ã®æ–¹ãŒä»£ç†åº—ã•ã‚“ãªã‚“ã§ã™ã‹ã­ï¼Ÿï¼ˆYESï¼‰<br>
                            ã¡ãªã¿ã«<span class="highlight">æœ€åˆã®ãŠæ”¯æ‰•ã„ã£ã¦ã‚‚ã†çµ‚ã‚ã£ã¦ã¾ã™ã‚ˆã­ï¼Ÿ</span>ï¼ˆYESï¼‰<br>
                            ã ã£ãŸã‚‰å¤§ä¸ˆå¤«ã§ã™ã‚ˆï¼<br><br>
                            ãªãœã‹ã¨è¨€ã„ã¾ã™ã¨ã€æœ€åˆã®ãŠæ”¯æ‰•ã„ãŒçµ‚ã‚ã£ãŸæ™‚ç‚¹ã§ãŠçŸ¥ã‚Šåˆã„ã®æ–¹ã«ã¯<span class="highlight">ç´¹ä»‹æ–™ãŒæŒ¯ã‚Šè¾¼ã¾ã‚Œã¦ã¾ã™</span>ã®ã§ä»ŠãŠå®¢æ§˜ãŒã©ã“ã«å¤‰ãˆã¦ã‚‚ãã®æ–¹ã«ã¯ä½•ã®å½±éŸ¿ã‚‚ãªã„ã®ã§ã”å®‰å¿ƒãã ã•ã„â˜†
                        </div>
                        <div class="modal-note">â€»ä»£ç†åº—ã«çŸ¥ã‚Šåˆã„ãŒã„ã‚‹å ´åˆã«æœ‰åŠ¹ãªãƒˆãƒ¼ã‚¯<br>â€»äººæƒ…ç³»ã¯æ­£ç›´é›£ã—ã„ã®ã§è¦‹åˆ‡ã‚Šä»˜ã‘ã¦è‡ªå®…æ¡ˆå†…ã«åˆ‡ã‚Šæ›¿ãˆ</div>
                    `},
                    { id: 'setDiscount', label: 'ã€Œã‚»ãƒƒãƒˆå‰²ãŒã‚ã‚‹ã€', title: 'ã€Œã‚¬ã‚¹ä»£ã€æºå¸¯ä»£ãªã©ã¨ã‚»ãƒƒãƒˆå‰²å¼•ãŒä»˜ã„ã¦ã‚‹ã€', content: `
                        <div class="modal-talk">
                            ãã¡ã‚‰ãªã‚“ã§ã™ãŒã€çµè«–<span class="highlight">ãƒˆãƒ¼ã‚¿ãƒ«ã§è¦‹ã‚‹ã¨ä»Šã‚ˆã‚ŠãŠå®‰ããªã‚‹</span>ã‚“ã§ã™ã­ï¼<br><br>
                            ã©ã†ã„ã†äº‹ã‹ã¨è¨€ã†ã¨ã€ä»Šå›ã”ç´¹ä»‹ã—ã¦ã„ã‚‹ãƒ‘ãƒ«ãƒ‘ãƒ¯ãƒ¼ã§ã‚“ãã«å¤‰æ›´ã—ã¾ã™ã¨ãŠã£ã—ã‚ƒã‚‰ã‚Œã¦ã‚‹ã‚»ãƒƒãƒˆå‰²å¼•ã¯ã¤ã‹ãªããªã£ã¦ã—ã¾ã†ã‚“ã§ã™ã­ã€‚<br><br>
                            ãŸã ã€ãã®åˆ†<span class="highlight">é›»æ°—æ–™é‡‘ã®æ–¹ã«å¤§å¹…ã«å‰²å¼•</span>ã‚’ä»˜ã‘ã•ã›ã¦ã„ãŸã ã„ã¦ã„ã‚‹ã®ã§çµæœçš„ã«åˆè¨ˆã§è¦‹ã‚‹ã¨ä»Šã‚ˆã‚ŠãŠå®‰ããªã‚‹ã‚“ã§ã™ã‚ˆï¼<br><br>
                            é›»æ°—ä»£ã¨ã‚¬ã‚¹ä»£ï¼ˆã‚±ãƒ¼ã‚¿ã‚¤ä»£ï¼‰ã®åˆè¨ˆãŒä»Šã‚ˆã‚Šã‚‚ãŠå®‰ããªã‚Œã°ã”å•é¡Œãªã„ã§ã™ã‚ˆã­ï¼Ÿâ˜†
                        </div>
                    `}
                ]
            },
            'step6c': {
                title: 'STEP 6-C: ã‚ªãƒ¼ãƒ«é›»åŒ–ç¢ºèª',
                name: 'ã‚ªãƒ¼ãƒ«é›»åŒ–ç¢ºèª',
                progress: 65,
                content: `
                    <div class="talk-display">
                        ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br>
                        <span class="highlight">ã‚ªãƒ¼ãƒ«é›»åŒ–ã‚„ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆ</span>ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ
                    </div>
                `,
                choices: [
                    { text: 'ãªã—', sub: 'âœ… ç²å¾—å¯èƒ½ â†’ æ˜ç´°ç¢ºèªã¸', next: 'step7', class: 'success' },
                    { text: 'ã‚ªãƒ¼ãƒ«é›»åŒ–/ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆ/ã‚¨ãƒãƒ•ã‚¡ãƒ¼ãƒ ã‚ã‚Š', sub: 'â†’ å‹•åŠ›ç¢ºèªã¸', next: 'step6d2', class: 'warning' }
                ],
                helps: []
            },
            'step6d': {
                title: 'STEP 6-D: å‹•åŠ›ç¢ºèª',
                name: 'å‹•åŠ›ç¢ºèª',
                progress: 65,
                content: `
                    <div class="talk-display">
                        ã§ã¯å¾“é‡é›»åŠ›ï¼ˆ100Vï¼‰ã¯ãŠå®‰ããŠä½¿ã„ã ã¨æ€ã†ã®ã§ã™ãŒâ™ª<br>
                        ã¡ãªã¿ã«<span class="highlight">å‹•åŠ›ï¼ˆä½åœ§é›»åŠ› 200Vï¼‰</span>ã¯ãŠä½¿ã„ã§ã™ã‹ï¼Ÿ
                    </div>
                    <div class="talk-display tip">
                        <span class="talk-note">ğŸ’¡ å‹•åŠ›ã®ä¾‹ï¼šæ¥­å‹™ç”¨ã‚¨ã‚¢ã‚³ãƒ³ã€å†·è”µåº«ã€é£Ÿæ´—æ©Ÿã€é›»å‹•ã‚·ãƒ£ãƒƒã‚¿ãƒ¼ã€ã‚³ãƒ³ãƒ—ãƒ¬ãƒƒã‚µãƒ¼ç­‰</span>
                    </div>
                `,
                choices: [
                    { text: 'å‹•åŠ›ä½¿ã£ã¦ã‚‹', sub: 'âœ… ç²å¾—å¯èƒ½ â†’ æ˜ç´°ç¢ºèªã¸', next: 'step7', class: 'success' },
                    { text: 'å‹•åŠ›ãªã—', sub: 'â†’ ã‚ªãƒ¼ãƒ«é›»åŒ–ç¢ºèª', next: 'step6d2', class: '' }
                ],
                helps: []
            },
            'step6d2': {
                title: 'STEP 6-D-2: ã‚ªãƒ¼ãƒ«é›»åŒ–ç¢ºèªï¼ˆå¯¾è±¡å¤–åˆ¤å®šï¼‰',
                name: 'ã‚ªãƒ¼ãƒ«é›»åŒ–ç¢ºèª',
                progress: 65,
                content: `
                    <div class="talk-display">
                        <span class="highlight">ã‚ªãƒ¼ãƒ«é›»åŒ–ã‚„ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆ</span>ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ
                    </div>
                `,
                choices: [
                    { text: 'ãªã—', sub: 'âœ… ç²å¾—å¯èƒ½ï¼ˆè¦ç¢ºèªï¼‰â†’ æ˜ç´°ç¢ºèªã¸', next: 'step7', class: 'success' },
                    { text: 'ã‚ªãƒ¼ãƒ«é›»åŒ–/ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆ/ã‚¨ãƒãƒ•ã‚¡ãƒ¼ãƒ ã‚ã‚Š', sub: 'é›»æ°—ã¯å¯¾è±¡å¤– â†’ ãƒãƒƒãƒˆæ¡ˆå†…ã¸', next: 'step8net', class: 'warning' }
                ],
                helps: []
            },
            'step6e': {
                title: 'STEP 6-E: é«˜åœ§ç¢ºèª',
                name: 'é«˜åœ§ç¢ºèª',
                progress: 65,
                content: `
                    <div class="talk-display">
                        <span class="highlight">ã‚­ãƒ¥ãƒ¼ãƒ“ã‚¯ãƒ«</span>ï¼ˆäº‹æ¥­æ‰€ã®å¤–ã¨ã‹ã«2mãã‚‰ã„ã®ç™½ã„å¤§ãã„ç®±ï¼‰ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ
                    </div>
                    <div class="talk-display tip">
                        <span class="talk-note">ğŸ’¡ é«˜åœ§ã®å¯èƒ½æ€§ãŒé«˜ã„äº‹æ¥­æ‰€ï¼šã‚¹ãƒ¼ãƒ‘ãƒ¼ã€ã‚´ãƒ«ãƒ•å ´ã€æ—…é¤¨ã€å·¥å ´ã€æ¸©æ³‰ã€è‘¬ç¥­å ´ã€æ•™ç¿’æ‰€ãªã©</span>
                    </div>
                `,
                choices: [
                    { text: 'ã‚ã‚‹/ã‚ã‚‹ã‹ã‚‚', sub: 'â†’ é«˜åœ§è©³ç´°ãƒ’ã‚¢ãƒªãƒ³ã‚°', next: 'step6e2', class: '' },
                    { text: 'ãªã„/ã‚ã‹ã‚‰ãªã„', sub: 'âœ… ç²å¾—å¯èƒ½ â†’ æ˜ç´°ç¢ºèªã¸', next: 'step7', class: 'success' }
                ],
                helps: []
            },
            'step6e2': {
                title: 'STEP 6-E-2: é«˜åœ§è©³ç´°ãƒ’ã‚¢ãƒªãƒ³ã‚°',
                name: 'é«˜åœ§è©³ç´°ãƒ’ã‚¢ãƒªãƒ³ã‚°',
                progress: 65,
                content: `
                    <div class="talk-display">
                        ï¼ˆã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ï¼‰<br>
                        ç¾åœ¨ã™ã¹ã¦ã®é›»åŠ›ä¼šç¤¾ãŒç‡ƒæ–™é«˜é¨°ã®ã‚ãŠã‚Šã‚’å—ã‘ã¦ã„ã‚‹ã“ã¨ã‚„ã€æ”¿åºœã®è£œå¡«ãŒçµ‚äº†ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ç­‰ã¯ã€ç‰¹ã«é›»æ°—ä»£ãŒã‚ãŒã‚‹ãŸã‚ã€ã„ã¾åˆ‡ã‚Šæ›¿ãˆã®æ¡ä»¶ãŒå‡ºã‚„ã™ã„æ™‚æœŸãªã‚“ã§ã™ã­ï¼<br><br>
                        é«˜åœ§ãŠä½¿ã„ã®å ´åˆã¯ã€<span class="highlight">ç›´è¿‘1å¹´åˆ†ã®æ˜ç´°ï¼ˆè«‹æ±‚æ›¸ï¼‰ã®ã”æº–å‚™</span>ã‚’ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™ã€‚<br>
                        æ¯æœˆã€é›»åŠ›ä¼šç¤¾ã•ã‚“ã‹ã‚‰å±Šãæ˜ç´°ã®ä¿ç®¡ã¯ã”ã–ã„ã¾ã™ã‹ï¼Ÿ
                    </div>
                `,
                choices: [
                    { text: 'æ˜ç´°ã‚ã‚‹', sub: 'â†’ æ›´æ–°æœˆç¢ºèª', action: 'showHelp', helpId: 'renewalMonth', class: 'primary' },
                    { text: 'æ˜ç´°ãªã„/ã‚ã‹ã‚‰ãªã„', sub: 'â†’ ç¢ºèªãŠé¡˜ã„ã—ã¦å†æ¶é›»', next: 'endRecallScheduled', class: '' }
                ],
                helps: [
                    { id: 'renewalMonth', label: 'æ›´æ–°æœˆç¢ºèª', title: 'æ›´æ–°æœˆç¢ºèª', content: `
                        <div class="modal-talk">
                            ã€Œã¡ãªã¿ã« <span class="highlight">æ›´æ–°æœˆã¯ã„ã¤é ƒ</span>ã§ã—ã‚‡ã†ã‹ï¼Ÿã€
                        </div>
                        <div class="modal-note">
                            ãƒ»æ›´æ–°ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚° â†’ âœ… ç²å¾—å¯èƒ½ â†’ æ˜ç´°ç¢ºèªã¸<br>
                            ãƒ»æ›´æ–°æœˆã§ãªã„ â†’ ã€Œé›»æ°—ã¯ã¾ãŸæ›´æ–°æœˆãŒè¿‘ã¥ãã¾ã—ãŸã‚‰ã€ã”ææ¡ˆã•ã›ã¦ã„ãŸã ãã¾ã™ã­ï¼ã€â†’ ãƒãƒƒãƒˆæ¡ˆå†…ã¸
                        </div>
                    `}
                ]
            },
            'step7': {
                title: 'STEP 7: æ˜ç´°ç¢ºèª',
                name: 'æ˜ç´°ç¢ºèª',
                progress: 70,
                content: `
                    <div class="talk-display">
                        ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼<br>
                        ã¡ãªã¿ã«ãŠæ–™é‡‘ã®ç¢ºèªã¯ã€æ¯æœˆå±Šã <span class="highlight">ç´™æ˜ç´°ï¼ˆæ¤œé‡ç¥¨ï¼‰</span>ã§ã™ã‹ï¼Ÿ<br>
                        ã‚‚ã—ãã¯ã€æºå¸¯ã‚„ãƒ‘ã‚½ã‚³ãƒ³ã‹ã‚‰ <span class="highlight">WEBæ˜ç´°</span>ã§ã¿ã‚‰ã‚Œã¦ã¾ã™ã‹ï¼Ÿ
                    </div>
                `,
                choices: [
                    { text: 'ç´™æ˜ç´°', sub: 'â†’ ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°ã¸', next: 'step9', class: 'primary' },
                    { text: 'WEBæ˜ç´°', sub: 'â†’ ID/PWç¢ºèªå¾Œã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°ã¸', action: 'showHelp', helpId: 'webBill', class: '' },
                    { text: 'ãƒãƒƒãƒˆã‚‚ä¸€ç·’ã«èããŸã„', sub: 'â†’ ãƒãƒƒãƒˆæ¡ˆå†…ã¸', next: 'step8net', class: '' }
                ],
                helps: [
                    { id: 'webBill', label: 'WEBæ˜ç´°ç¢ºèª', title: 'WEBæ˜ç´°ã®å ´åˆã®ç¢ºèª', content: `
                        <div class="modal-talk">
                            ã€Œãƒã‚¤ãƒšãƒ¼ã‚¸ã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ãŸã‚ã®<span class="highlight">IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</span>ã¯ãŠæŒã¡ã§ã™ã‹ï¼Ÿã€
                        </div>
                        <div class="modal-note">â†’ ç¢ºèªå¾Œã€Œç´™æ˜ç´°ã€ãƒœã‚¿ãƒ³ã§ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°ã¸é€²ã‚€</div>
                    `}
                ]
            },
            'step8net': {
                title: 'STEP 8: ãƒãƒƒãƒˆãƒ»é›»è©±å›ç·šæ¡ˆå†…',
                name: 'ãƒãƒƒãƒˆæ¡ˆå†…',
                progress: 75,
                content: `
                    <div class="talk-display">
                        é›»æ°—ã¯æ›¿ãˆã‚‰ã‚Œãªã„ã‚ˆãƒ¼ï¼ã¨ãŠã£ã—ã‚ƒã‚‹ãŠå®¢æ§˜ã«ã¯ã€<br>
                        <span class="highlight">é€šä¿¡ä¼šç¤¾ã•ã¾ã«ã‚‚å”è³›</span>ã„ãŸã ã„ã¦ã„ã‚‹ãŸã‚ã€<br>
                        ãƒãƒƒãƒˆå›ç·šã‚„ãŠé›»è©±å›ç·šã®ç„¡æ–™è¦‹ç©ã‚Šã‚’ã¿ã¦ã„ãŸã ãã“ã¨ã§ã‚‚å¯¾å¿œã•ã›ã¦ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™â™ª<br><br>
                        ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«é–¢ã—ã¾ã—ã¦ã¯ã€ã™ã§ã«NTTã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã•ã‚Œã¦ã„ã‚‹ãŠå®¢æ§˜ã¸ã€ã„ã¾ãŠä½¿ã„ã®ç’°å¢ƒãªã©ã¯å¤‰ã‚ã‚‰ãšæœˆã€…ã®ã”è² æ‹…ã§ã‚ã‚‹<span class="highlight">å›ºå®šè²»å‰Šæ¸›</span>ã®ã”ææ¡ˆãŒã§ãã¾ã™â™ª<br><br>
                        ã¡ãªã¿ã«ã€ãƒãƒƒãƒˆå›ç·šã¯ã©ã¡ã‚‰ã§ãŠç¹‹ãã§ã—ã‚‡ã†ã‹ï¼Ÿ
                    </div>
                `,
                choices: [
                    { text: 'NTTç³»ï¼ˆãƒ•ãƒ¬ãƒƒãƒ„å…‰ç­‰ï¼‰', sub: 'â†’ NTTç³»ãƒ’ã‚¢ãƒªãƒ³ã‚°', next: 'step8netA', class: 'primary' },
                    { text: 'eoå…‰/J:COM/ã‚±ãƒ¼ãƒ–ãƒ«ç³»', sub: 'â†’ åˆ‡ã‚Šæ›¿ãˆææ¡ˆ', next: 'step8netB', class: '' },
                    { text: 'ã‚¢ãƒŠãƒ­ã‚°é›»è©±ã®ã¿', sub: 'â†’ å…‰é›»è©±ææ¡ˆ', next: 'step8netC', class: '' },
                    { text: 'ã‚ã‹ã‚‰ãªã„', sub: 'â†’ NTTæ©Ÿå™¨ç¢ºèª', action: 'showHelp', helpId: 'checkNtt', class: '' }
                ],
                helps: [
                    { id: 'checkNtt', label: 'NTTæ©Ÿå™¨ç¢ºèª', title: 'ãƒãƒƒãƒˆç¹‹ã„ã§ã‚‹ã‘ã©ã€ã©ã“ã‹ã‚ã‹ã‚‰ãªã„å ´åˆ', content: `
                        <div class="modal-talk">
                            ãƒ»ãŠé›»è©±æ©Ÿã®è¿‘ãã«<span class="highlight">é»’è‰²ã®ãŠå¼å½“ç®±ã‚µã‚¤ã‚º</span>ï¼ˆæ‰‹ã®ã²ã‚‰ã‚µã‚¤ã‚ºï¼‰ã®ãƒã‚«ãƒã‚«ã²ã‹ã‚‹æ©Ÿæ¢°ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ<br><br>
                            â†’ ã‚ã‚‹å ´åˆï¼šã€Œãã¡ã‚‰ã«<span class="highlight">NTTã¨ã„ã†ãƒ­ã‚´</span>ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿã€<br>
                            â†’ ã‚ã‚‹ â†’ã€Œãã¡ã‚‰ãŒã‚ã‚Œã°NTTå…‰å›ç·šã§ãƒãƒƒãƒˆãŠä½¿ã„ã§ã™ã€‚ã€<br><br>
                            ãƒ»æ¯æœˆNTTã•ã‚“ã‹ã‚‰è«‹æ±‚æ›¸ã¯å±Šã„ã¦ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ<br>
                            â†’ å±Šã„ã¦ã„ã‚‹ â†’ NTTå›ç·šã§ãƒãƒƒãƒˆãŠä½¿ã„ã§ã™
                        </div>
                        <div class="modal-note">â†’ ç¢ºèªå¾Œã€é©åˆ‡ãªé¸æŠè‚¢ã‚’é¸ã‚“ã§ãã ã•ã„</div>
                    `}
                ]
            },
            'step8netA': {
                title: 'STEP 8-NET-A: NTTå…‰å›ç·šç³»',
                name: 'NTTç³»ãƒ’ã‚¢ãƒªãƒ³ã‚°',
                progress: 80,
                content: `
                    <div class="talk-display">
                        NTTå…‰å›ç·šç³»ã‚’ãŠä½¿ã„ãªã‚“ã§ã™ã­ï¼
                    </div>
                    <div class="talk-display tip">
                        <strong>ãƒ’ã‚¢ãƒªãƒ³ã‚°é …ç›®</strong><br>
                        ãƒ»æœˆã€…ãŠã„ãã‚‰ãã‚‰ã„ãŠæ”¯æ‰•ã„ã§ã™ã‹ï¼Ÿ<br>
                        ãƒ»ãƒ—ãƒ­ãƒã‚¤ãƒ€ã¯ã©ã¡ã‚‰ãŠä½¿ã„ã§ã™ã‹ï¼Ÿ<br>
                        ãƒ»æ™®æ®µãŠæ–™é‡‘ã¯ã©ã®ã‚ˆã†ã«ç¢ºèªã•ã‚Œã¦ã¾ã™ã‹ï¼Ÿ<br>
                        ãƒ»æ˜ç´°ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿï¼ˆç´™ or WEBï¼Ÿï¼‰
                    </div>
                `,
                choices: [
                    { text: 'ãƒ’ã‚¢ãƒªãƒ³ã‚°å®Œäº†', sub: 'â†’ ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°ã¸', next: 'step9', class: 'success' },
                    { text: 'ãƒãƒƒãƒˆã‚‚ã„ã‚‰ãªã„', sub: 'â†’ å¯¾è±¡å¤–', next: 'endNotTarget', class: 'danger' }
                ],
                helps: []
            },
            'step8netB': {
                title: 'STEP 8-NET-B: eoå…‰/J:COMç­‰',
                name: 'eoå…‰ç­‰ã®å¯¾å¿œ',
                progress: 80,
                content: `
                    <div class="talk-display">
                        ä»Šå›ã¯NTTå…‰å›ç·šç³»ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå›ç·šã®æ¡ˆå†…ã¨ãªã‚‹ã‚“ã§ã™ãŒã€<br>
                        <span class="highlight">ãŠä»•äº‹ã§ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã”åˆ©ç”¨</span>ã£ã¦ã”ã–ã„ã¾ã™ã§ã—ã‚‡ã†ã‹ï¼Ÿ
                    </div>
                `,
                choices: [
                    { text: 'ãƒ¡ãƒ¼ãƒ«ä½¿ã£ã¦ãªã„', sub: 'â†’ NTTåˆ‡ã‚Šæ›¿ãˆææ¡ˆ', action: 'showHelp', helpId: 'nttSwitch', class: 'primary' },
                    { text: 'ãƒ¡ãƒ¼ãƒ«ä½¿ã£ã¦ã‚‹', sub: 'â†’ åˆ‡ã‚Šæ›¿ãˆé›£ã—ã„', next: 'endNotTarget', class: '' }
                ],
                helps: [
                    { id: 'nttSwitch', label: 'NTTåˆ‡ã‚Šæ›¿ãˆææ¡ˆ', title: 'NTTåˆ‡ã‚Šæ›¿ãˆææ¡ˆ', content: `
                        <div class="modal-talk">
                            ãã‚Œã§ã‚ã‚Œã°ã€NTTã®å›ç·šã‚’ãŠä½¿ã„ã„ãŸã ãã“ã¨ã§ã€é€šä¿¡è²»ãŒä»Šã‚ˆã‚ŠãŠãƒˆã‚¯ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã®ã§ã€å®Ÿéš›ã«ã©ã®ãã‚‰ã„ãŠå®‰ããªã‚‹ã‹ãŠè©±ã‚’èã„ã¦ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ï¼
                        </div>
                        <div class="modal-note">
                            Q.ã€Œå·¥äº‹è²»ç”¨ã‚„é•ç´„é‡‘ã¯ï¼Ÿã€<br>
                            A. ä»Šå›ã¯ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ãªã®ã§ã€ã™ã¹ã¦å¼Šç¤¾è² æ‹…ã§ã™ï¼
                        </div>
                    `}
                ]
            },
            'step8netC': {
                title: 'STEP 8-NET-C: ã‚¢ãƒŠãƒ­ã‚°å›ç·š',
                name: 'ã‚¢ãƒŠãƒ­ã‚°å›ç·šå¯¾å¿œ',
                progress: 80,
                content: `
                    <div class="talk-display">
                        ã‚¢ãƒŠãƒ­ã‚°ã®ãŠé›»è©±ã ã‘ã§ãŠä½¿ã„ã§ã™ã‹ï¼Ÿ<br><br>
                        ã‚†ãã‚†ãã¯<span class="highlight">ã‚¢ãƒŠãƒ­ã‚°å›ç·šï¼ˆé€šå¸¸å›ç·šï¼‰ãŒå»ƒæ­¢</span>ã¨ãªã‚‹ãŸã‚ã€ã‚¢ãƒŠãƒ­ã‚°å›ç·šã‹ã‚‰å…‰å›ç·šç§»è¡Œã®æ¡ˆå†…ãŒåºƒã¾ã‚Šã¤ã¤ã‚ã‚‹ã®ã§ã™ãŒãŠå®¢æ§˜ã®ã¨ã“ã‚ã«ã¯ã€NTTã•ã‚“ã‚„ã‚½ãƒ•ãƒˆãƒãƒ³ã‚¯ã•ã‚“ã‹ã‚‰ã“ã†ã„ã†æ¡ˆå†…ã®ãŠçŸ¥ã‚‰ã›ã¨ã‹ã£ã¦ã‚‚ã†å±Šãã¾ã—ãŸã‹ï¼Ÿï¼Ÿ<br><br>
                        ã‚¢ãƒŠãƒ­ã‚°ã§ãŠä½¿ã„ã„ãŸã ãã‚ˆã‚Šã€æœˆã€…ã®åŸºæœ¬æ–™é‡‘ã‚‚é€šè©±æ–™ã‚‚ãŠå®‰ã„<span class="highlight">å…‰é›»è©±</span>ã«ã¿ãªã•ã¾é †ã€…ã«åˆ‡æ›¿ãˆã¦ã„ãŸã ã„ã¦ã¾ã—ã¦ã€å¼Šç¤¾ã¯ä»Šå›ãã®ã”æ¡ˆå†…ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ï¼
                    </div>
                    <div class="talk-display tip">
                        <span class="talk-note">ğŸ’¡ NTTã•ã‚“ã¯2026å¹´ä»¥é™ã€å…‰å›ç·šã¸ã®åˆ‡ã‚Šæ›¿ãˆã‚’ã•ã‚‰ã«é€²ã‚ã‚‹äºˆå®šã§ã™ã€‚æœ€çµ‚çš„ã«ã¯ã€2030å¹´ï½2035å¹´åº¦ã‚’ç›®å‡¦ã«å…¨å›½çš„ã«ã‚¢ãƒŠãƒ­ã‚°ã‹ã‚‰å…‰ã¸ã®ç§»è¡ŒãŒå®Œäº†ã™ã‚‹è¦‹è¾¼ã¿ã§ã™ã€‚</span>
                    </div>
                `,
                choices: [
                    { text: 'èˆˆå‘³ã‚ã‚‹/èã„ã¦ã¿ã‚‹', sub: 'â†’ ãƒ’ã‚¢ãƒªãƒ³ã‚°å¾Œã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°ã¸', next: 'step9', class: 'success' },
                    { text: 'ã„ã‚‰ãªã„', sub: 'â†’ å¯¾è±¡å¤–', next: 'endNotTarget', class: '' }
                ],
                helps: [
                    { id: 'cantInstall', label: 'ã€Œéå»ã«å¼•ã‘ãªã„ã¨è¨€ã‚ã‚ŒãŸã€', title: 'ã€Œéå»ã«ãƒãƒƒãƒˆå¼•ã‘ãªã„ã¨è¨€ã‚ã‚ŒãŸã“ã¨ãŒã‚ã‚‹ã€', content: `
                        <div class="modal-talk">
                            ã€Œãªãœã ã‚ã ã£ãŸã‹ã€ã®ç†ç”±ã«ã‚‚ã‚ˆã‚Šã¾ã™ãŒã€ãã®ã‚ˆã†ã«ãŠã£ã—ã‚ƒã‚‹ãŠå®¢æ§˜ã£ã¦å®Ÿã¯å¤šã„ã‚“ã§ã™ã‚ˆï¼<br><br>
                            å·¥äº‹æ‹…å½“è€…ã«ã‚ˆã£ã¦åˆ¤æ–­ãŒã•ã¾ã–ã¾ã ã¨ã„ã†ã“ã¨ã‚‚1ã¤ã®è¦å› ãªã®ã§ã™ãŒã€ãŸã¨ãˆã°ä½œæ¥­å“¡ã®ã€ŒçµŒé¨“å€¤ãƒ»ãã®æ—¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ãªã©ã«ã‚ˆã£ã¦ã‚‚å°å…¥ã§ãã‚‹ã‹å¦ã‹ã®çµæœãŒå·¦å³ã•ã‚Œã‚‹ã‚±ãƒ¼ã‚¹ãŒå°‘ãªããªã„ã‚“ã§ã™ã­ã€‚<br><br>
                            ãŸã å¼Šç¤¾ã§ã¯ã€<span class="highlight">é•·å¹´ãŠä»˜ãåˆã„ã®ã‚ã‚‹å…¥ç·šå°‚é–€æ¥­è€…ã•ã‚“</span>ã«ãŠé¡˜ã„ã—ã¦ãŠã‚Šã¾ã™ã®ã§ã€ä»Šã¾ã§ä»–ç¤¾ã•ã‚“ã§"é›£ã—ã„"ã¨ã•ã‚Œã¦ã„ãŸãŠå®¢æ§˜ã§ã‚‚<span class="highlight">"é–‹é€šã§ããŸã‚ˆâ˜†"ã£ã¦ã‚±ãƒ¼ã‚¹ãŒå¤šã</span>å¤§å¤‰å–œã°ã‚Œã¦ã„ã¾ã™ï¼
                        </div>
                    `}
                ]
            },
            'step9': {
                title: 'STEP 9: ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°',
                name: 'ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°',
                progress: 85,
                content: `
                    <div class="talk-display">
                        ä»Šå›ã®å†…å®¹ã‚’ç°¡å˜ã«ã¾ã¨ã‚ã‚‹ã¨<br><br>
                        æ¯æœˆãŠæ”¯æ‰•ã„ã®ï¼ˆé›»æ°—æ–™é‡‘ ï¼ ãƒãƒƒãƒˆæ–™é‡‘ ï¼ ãŠé›»è©±å›ç·šã®æ–™é‡‘ï¼‰ãŒ<br>
                        <span class="highlight">ä»Šã‚ˆã‚Šã©ã‚Œãã‚‰ã„ãŠå®‰ããªã‚‹ã‹</span>è¦‹ã¦ã„ãŸã ã‘ã¦<br><br>
                        ã€æ’®å½±ã‚ã‚Šã®æ–¹ã€‘ğŸ“·<br>
                        <span class="highlight">ã‚°ãƒ¼ã‚°ãƒ«æ’®å½±ã‚‚ç„¡æ–™ã§å—ã‘ã¦ã„ãŸã ã‘ã‚‹</span> ã¨ã„ã†ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã«ãªã‚Šã¾ã™â™ª<br><br>
                        ã€æ’®å½±ãªã—ã®æ–¹ã€‘ğŸ’°<br>
                        <span class="highlight">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒãƒƒã‚¯ã‚’å—ã‘ã¦ã„ãŸã ã‘ã‚‹</span> ã¨ã„ã†ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã«ãªã‚Šã¾ã™â™ª<br><br>
                        è‰²ã€…ãŠä¼ãˆã—ã¾ã—ãŸãŒã€ä»Šå›ã®å†…å®¹ã¯<span class="highlight">è²»ç”¨ã¯ä¸€åˆ‡ã‹ã‹ã‚‰ãªã„</span>ã§ã™ï¼
                    </div>
                `,
                choices: [
                    { text: 'ã‚ã‹ã£ãŸ/ã„ã„ã‚ˆ', sub: 'â†’ ã‚¢ãƒç¢ºå®šã¸', next: 'step10', class: 'success' },
                    { text: 'ãƒã‚¤ãƒã‚¤ç³»/åå¿œè–„ã„', sub: 'â†’ å¿µæŠ¼ã—ãƒˆãƒ¼ã‚¯', action: 'showHelp', helpId: 'pushBack', class: '' },
                    { text: 'ã‚„ã£ã±ã‚Šã„ã‚‰ãªã„', sub: 'â†’ åˆ‡ã‚Šè¿”ã— or çµ‚äº†', action: 'showHelp', helpId: 'dontNeed', class: 'danger' }
                ],
                helps: [
                    { id: 'pushBack', label: 'ãƒã‚¤ãƒã‚¤ç³»ã¸ã®å¿µæŠ¼ã—', title: 'ãƒã‚¤ãƒã‚¤ç³»ã¸ã®å¿µæŠ¼ã—ãƒˆãƒ¼ã‚¯', content: `
                        <div class="modal-talk">
                            ã€Œã”èª¬æ˜ã¯ä»¥ä¸Šã«ãªã‚Šã¾ã™ãŒã€<br>
                            ã“ã“ã¾ã§ã®ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã«ã¤ã„ã¦<span class="highlight">ã”ä¸æ˜ç‚¹ã¯ãªã‹ã£ãŸã§ã™ã‹ï¼Ÿ</span>ã€ã¨è»½ãå¿µæŠ¼ã—ã€‚
                        </div>
                        <div class="modal-note">â†’ ç¢ºèªå¾Œã€Œã‚ã‹ã£ãŸ/ã„ã„ã‚ˆã€ã‚’é¸æŠ</div>
                    `},
                    { id: 'dontNeed', label: 'ã€Œã„ã‚‰ãªã„ã€ã¸ã®å¯¾å¿œ', title: 'ã‚„ã£ã±ã‚Šã„ã‚‰ãªã„ã¸ã®å¯¾å¿œ', content: `
                        <div class="modal-talk">
                            <strong>Q.ã€Œã“ã£ã¡ãŒãªã‚“ã‹ã™ã‚‹ã“ã¨ã‚ã‚‹ã®ï¼Ÿãƒ»æ‰‹ç¶šãã‚ã‚“ã©ã„ç³»ã€</strong><br>
                            A. ä»Šå›ã€<span class="highlight">é¢å€’ãªãŠæ‰‹ç¶šãã¯ä¸€åˆ‡ã”ã–ã„ã¾ã›ã‚“ï¼</span><br>
                            åŒã˜ã‚ˆã†ãªã”å¿ƒé…äº‹ã‚’ãŠæŒã¡ã®äº‹æ¥­è€…æ§˜ãŒå¤šãã„ã‚‰ã£ã—ã‚ƒã‚‹ã®ã§ã™ãŒã€å®Ÿéš›ã®ã¨ã“ã‚<span class="highlight">"ç„¡æ–™ã‚µãƒãƒ¼ãƒˆ"ã§ã‚«ãƒãƒ¼</span>ã§ãã¦ãŠã‚Šã¾ã™ã®ã§ã”å®‰å¿ƒãã ã•ã„â˜†
                        </div>
                    `},
                    { id: 'bankruptcy', label: 'ã€Œæ–°é›»åŠ›ã¯å€’ç”£ãŒå¿ƒé…ã€', title: 'ã€Œæ–°é›»åŠ›ä¼šç¤¾ã®å€’ç”£ã‚„äº‹æ¥­æ’¤é€€ã‚’æ°—ã«ã—ã¦ã‚‹ã€', content: `
                        <div class="modal-talk">
                            ãã†ãªã‚“ã§ã™ã‚ˆã€œï¼ãŠå®¢æ§˜ãŒä»°ã‚‹é€šã‚Šã€ã“ã“1.2å¹´ã®ç‡ƒæ–™é«˜é¨°ã®ã‚ãŠã‚Šã‚’å—ã‘ã¦å€’ç”£ã•ã‚Œã¦ã‚‹ä¼šç¤¾ã•ã‚“ã‚‚ã‚ã‚‹ã®ã§ã™ãŒ<br><br>
                            <strong>ã€ãƒãƒ«ã¨ãã®å ´åˆã€‘</strong><br>
                            ä»Šå›ç§ã©ã‚‚ãŒã”ç´¹ä»‹ã—ã¦ã‚‹ãƒãƒ«ã¨ãã§ã‚“ãã¯ã€äº‹æ¥­æ‰€æ§˜å‘ã‘ã«å‰²å¼•ã‚’ã”æ¡ˆå†…ã—ã¦ã‚‹ä¼šç¤¾ã®ä¸­ã§<span class="highlight">ã‚·ã‚§ã‚¢ãŒ1ä½</span>ã®ä¼šç¤¾ãªã‚“ã§ã™ã­ï¼æ¯ä½“ã®ä¼šç¤¾ã‚‚ï¼ˆå…‰é€šä¿¡ã£ã¦ã„ã†ï¼‰<span class="highlight">æ±è¨¼ãƒ—ãƒ©ã‚¤ãƒ ä¸Šå ´</span>ã®å¤§ãã„ä¼šç¤¾ã«ãªã‚Šã¾ã™ã®ã§ã€ãã®ã‚ãŸã‚Šã¯ã¿ãªã•ã‚“å®‰å¿ƒã—ã¦å‰²å¼•ã‚’å—ã‘ã¦ã„ãŸã ã„ã¦ã¾ã™ã€œï¼
                        </div>
                    `}
                ]
            },
            'step10': {
                title: 'STEP 10: ã‚¢ãƒç¢ºå®š',
                name: 'ã‚¢ãƒç¢ºå®š',
                progress: 95,
                content: `
                    <div class="talk-display">
                        ãã‚Œã§ã¯ã“ã®å¾Œã€æœ¬æ—¥ä¸­ã«ï¼ˆé€£ä¼‘æ˜ã‘ã‹ã‚‰é †ç•ªã«ï¼‰<br>
                        æ’®å½±éƒ¨ç½²ã®è€…ã‹ã‚‰ <span class="highlight">ç°¡å˜ãªã”ç¢ºèªãƒ»è¨ªå•ã®æ—¥æ™‚ã‚’æ±ºã‚ã‚‹ãŠé›»è©±</span>ãŒã‚‚ã†ä¸€æœ¬å…¥ã‚Šã¾ã™ã®ã§ã€ãã¡ã‚‰ã ã‘ã”å¯¾å¿œãŠé¡˜ã„ã—ã¾ã™(*^^*)
                    </div>
                `,
                choices: [
                    { text: 'ã‚ã‹ã£ãŸ', sub: 'â†’ åå‰ç¢ºèªã¸', action: 'showHelp', helpId: 'getName', class: 'success' },
                    { text: 'ã“ã®ã‚ã¨å‡ºæ›ã‘ã‚‹/å¿™ã—ã„', sub: 'â†’ æºå¸¯ç•ªå·ç¢ºèª', action: 'showHelp', helpId: 'getMobile', class: '' }
                ],
                helps: [
                    { id: 'getName', label: 'åå‰ç¢ºèª', title: 'åå‰ç¢ºèª â†’ å®Œäº†ï¼', content: `
                        <div class="modal-talk">
                            ç§ã€‡ã€‡ã¨ç”³ã—ã¾ã™ãŒå¤±ç¤¼ãŒãªã„ã‚ˆã†ã«ãŠé›»è©±å£æ§˜ã®<span class="highlight">ãŠåå‰</span>ã‚’ãŠä¼ºã„ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ<br><br>
                            ã§ã¯ã€‡ã€‡æ§˜å®›ã«ãŠé›»è©±ã„ãŸã—ã¾ã™ã®ã§ã€ã”å¯¾å¿œã ã‘ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚<br>
                            ã§ã¯å¤±ç¤¼è‡´ã—ã¾ã™ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸâ˜†<br><br>
                            <strong>ï¼ˆæœ€å¾Œã¾ã§ä¸å¯§ã«ï¼ï¼‰</strong>
                        </div>
                        <div class="modal-note" style="background: #d3f9d8; color: #1b5e20;">â†’ ç¢ºèªå®Œäº†å¾Œã€ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã¦ã€ŒğŸ‰ ã‚¢ãƒç²å¾—ï¼ã€ã¸</div>
                    `},
                    { id: 'getMobile', label: 'æºå¸¯ç•ªå·ç¢ºèª', title: 'æºå¸¯ç•ªå·ç¢ºèª', content: `
                        <div class="modal-talk">
                            å·®ã—æ”¯ãˆãŒãªã‘ã‚Œã°<span class="highlight">æºå¸¯ç•ªå·</span>ã‚’ãŠä¼ºã„ã§ãã¾ã™ã§ã—ã‚‡ã†ã‹ï¼Ÿ<br>
                            ãã¡ã‚‰ã«ãŠæ›ã‘ã•ã›ã¦ã„ãŸã ãã¾ã™ã­ï¼
                        </div>
                        <div class="modal-note">â€»æºå¸¯ã®ç•ªå·ã¯ã€ç•™å®ˆè»½æ¸›ã®ãŸã‚ãªã‚‹ã¹ãèã„ã¦ãã ã•ã„ã€‚<br>â†’ ç¢ºèªå¾Œã€åå‰ç¢ºèªã¸</div>
                    `}
                ],
                nextAfterHelp: 'endSuccess'
            },
            'endSuccess': {
                title: 'ğŸ‰ ã‚¢ãƒç²å¾—ï¼',
                name: 'ã‚¢ãƒç²å¾—å®Œäº†',
                progress: 100,
                isEnd: true,
                endType: 'success',
                content: `
                    <div class="end-screen success">
                        <div class="icon">ğŸ‰</div>
                        <h2>ã‚¢ãƒå—æ³¨å®Œäº†ï¼<br>ãŠç–²ã‚Œæ§˜ã§ã—ãŸ</h2>
                        <div class="checklist">
                            <div class="checklist-item">â˜‘ ä¼šç¤¾åï¼š___________________</div>
                            <div class="checklist-item">â˜‘ æ‹…å½“è€…åï¼š___________________</div>
                            <div class="checklist-item">â˜‘ é›»è©±ç•ªå·ï¼š___________________</div>
                            <div class="checklist-item">â˜‘ æºå¸¯ç•ªå·ï¼š___________________</div>
                            <div class="checklist-item">â˜‘ æ¡ˆå†…å†…å®¹ï¼šâ–¡é›»æ°— â–¡ãƒãƒƒãƒˆ â–¡é›»è©±å›ç·š</div>
                            <div class="checklist-item">â˜‘ æ˜ç´°ï¼šâ–¡ç´™ â–¡WEBï¼ˆID/PWç¢ºèªæ¸ˆï¼‰</div>
                            <div class="checklist-item">â˜‘ æ’®å½±ï¼šâ–¡ã‚ã‚Š â–¡ãªã—ï¼ˆCBæ¡ˆå†…ï¼‰</div>
                        </div>
                        <div class="end-buttons">
                            <button class="end-btn primary" onclick="resetNavi()">ğŸ”„ æœ€åˆã‹ã‚‰</button>
                            <a href="index.html" class="end-btn secondary" style="text-decoration:none;">ğŸ“– ãƒãƒ‹ãƒ¥ã‚¢ãƒ«</a>
                        </div>
                    </div>
                `,
                choices: [],
                helps: []
            },
            'endNotTarget': {
                title: 'å¯¾è±¡å¤–',
                name: 'å¯¾è±¡å¤–çµ‚äº†',
                progress: 100,
                isEnd: true,
                endType: 'notTarget',
                content: `
                    <div class="step-card">
                        <div class="step-title">ğŸ“‹ å¯¾è±¡å¤–</div>
                        <div class="talk-display">
                            ç¾çŠ¶ã©ã¡ã‚‰ã‚‚ãŠå®‰ãã”åˆ©ç”¨ã„ãŸã ã„ã¦ã„ã‚‰ã£ã—ã‚ƒã„ã¾ã™ã®ã§ã€<br>
                            <span class="highlight">ä»Šå›ã¯ã”æ¡ˆå†…æ§ãˆã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚</span><br>
                            ãŠæ™‚é–“ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼<br><br>
                            æ–°ãŸãªã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ãŒå‡ºã¾ã—ãŸã‚‰ã€ãã®æ™‚ã¯ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ããŸã„ã¨æ€ã„ã¾ã™ï¼<br>
                            ã¾ãŸã”æ©Ÿä¼šãŒã‚ã‚Œã°ãŠé¡˜ã„ã„ãŸã—ã¾ã™â™ª<br><br>
                            <strong>ï¼ˆæœ€å¾Œã¾ã§ä¸å¯§ã«ï¼‰</strong>
                        </div>
                    </div>
                `,
                choices: [
                    { text: 'ğŸ”„ æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™', next: 'step1', class: 'primary' },
                    { text: 'ğŸ  ä»£è¡¨è€…è‡ªå®…æ¡ˆå†…ã‚’è©¦ã™', sub: 'â†’ é›»åŠ›åˆ¤åˆ¥ã‹ã‚‰', action: 'showHelp', helpId: 'homeOffer', class: '' }
                ],
                helps: [
                    { id: 'homeOffer', label: 'è‡ªå®…æ¡ˆå†…', title: 'ä»£è¡¨è€…è‡ªå®…æ¡ˆå†…ãƒˆãƒ¼ã‚¯', content: `
                        <div class="modal-talk">
                            ã€Œä»Šå›ã¯ä»£è¡¨è€…æ§˜ã®<span class="highlight">ã”è‡ªå®…ã‚‚ã€ç‰¹åˆ¥ã«äº‹æ¥­ç”¨å‰²å¼•ã®ã”æ¡ˆå†…ãŒå¯èƒ½</span>ã§ã—ã¦ã€œâ™ªã€
                        </div>
                        <div class="modal-note">â†’ STEP 5ï¼ˆé›»åŠ›ä¼šç¤¾åˆ¤åˆ¥ï¼‰ã‹ã‚‰å†é–‹</div>
                    `}
                ]
            },
            'endRecall': {
                title: 'å†æ¶é›»',
                name: 'å†æ¶é›»çµ‚äº†',
                progress: 100,
                isEnd: true,
                endType: 'recall',
                content: `
                    <div class="step-card">
                        <div class="step-title">ğŸ“ å†æ¶é›»ãƒªã‚¹ãƒˆã«è¿½åŠ </div>
                        <div class="talk-display tip">
                            <strong>ãƒ¡ãƒ¢</strong><br>
                            ãƒ»ä¼šç¤¾åï¼š___________________<br>
                            ãƒ»å†æ¶é›»æ—¥æ™‚ï¼š___________________<br>
                            ãƒ»å‚™è€ƒï¼š___________________
                        </div>
                    </div>
                `,
                choices: [
                    { text: 'ğŸ”„ æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™', next: 'step1', class: 'primary' }
                ],
                helps: []
            },
            'endRecallScheduled': {
                title: 'å†æ¶é›»äºˆç´„',
                name: 'å†æ¶é›»äºˆç´„å®Œäº†',
                progress: 100,
                isEnd: true,
                endType: 'recallScheduled',
                content: `
                    <div class="step-card">
                        <div class="step-title">ğŸ“… å†æ¶é›»äºˆç´„å®Œäº†</div>
                        <div class="talk-display success">
                            <strong>å†æ¶é›»äºˆç´„ã‚’è¨˜éŒ²ã—ã¦ãã ã•ã„</strong><br><br>
                            ãƒ»ä¼šç¤¾åï¼š___________________<br>
                            ãƒ»æ‹…å½“è€…åï¼š___________________<br>
                            ãƒ»å†æ¶é›»æ—¥æ™‚ï¼š___________________<br>
                            ãƒ»å‚™è€ƒï¼š___________________
                        </div>
                    </div>
                `,
                choices: [
                    { text: 'ğŸ”„ æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™', next: 'step1', class: 'primary' }
                ],
                helps: []
            }
        };

        let currentStep = 'step1';
        let history = [];
        let forwardHistory = [];

        function initNavi() {
            renderStep(currentStep);
        }

        function renderStep(stepId) {
            const step = STEPS[stepId];
            if (!step) return;

            currentStep = stepId;

            // é€²æ—æ›´æ–°
            document.getElementById('stepLabel').textContent = step.title.split(':')[0];
            document.getElementById('stepName').textContent = step.name;
            document.getElementById('progressFill').style.width = step.progress + '%';

            // é€²è¡Œåº¦ãƒ•ã‚§ãƒ¼ã‚ºè¡¨ç¤º
            const phaseEl = document.getElementById('stepPhase');
            if (step.progress <= 30) {
                phaseEl.textContent = 'åºç›¤';
                phaseEl.className = 'step-phase early';
            } else if (step.progress <= 70) {
                phaseEl.textContent = 'ä¸­ç›¤';
                phaseEl.className = 'step-phase mid';
            } else {
                phaseEl.textContent = 'çµ‚ç›¤';
                phaseEl.className = 'step-phase late';
            }

            // æˆ»ã‚‹ãƒ»é€²ã‚€ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°ã¨å‹•çš„ãƒ©ãƒ™ãƒ«
            const backBtn = document.getElementById('backBtn');
            const forwardBtn = document.getElementById('forwardBtn');

            backBtn.disabled = history.length === 0;
            forwardBtn.disabled = forwardHistory.length === 0;

            // å‹•çš„ãƒ©ãƒ™ãƒ«
            if (history.length > 0) {
                backBtn.innerHTML = 'â† æˆ»ã‚‹<span class="btn-count">(' + history.length + ')</span>';
            } else {
                backBtn.textContent = 'â† æˆ»ã‚‹';
            }

            if (forwardHistory.length > 0) {
                forwardBtn.innerHTML = 'é€²ã‚€ â†’<span class="btn-count">(' + forwardHistory.length + ')</span>';
            } else {
                forwardBtn.textContent = 'é€²ã‚€ â†’';
            }

            // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆ
            let html = `<div class="step-card">`;
            html += `<div class="step-title">${step.title}</div>`;
            html += step.content;

            // é¸æŠè‚¢
            if (step.choices && step.choices.length > 0) {
                const colClass = step.choices.length === 2 ? 'two-col' : '';
                html += `<div class="choices ${colClass}">`;
                step.choices.forEach((choice, index) => {
                    const classStr = choice.class || '';
                    if (choice.action === 'showHelp') {
                        html += `<button class="choice-btn ${classStr}" onclick="showHelp('${choice.helpId}')">${choice.text}${choice.sub ? `<span class="btn-sub">${choice.sub}</span>` : ''}</button>`;
                    } else if (choice.next) {
                        html += `<button class="choice-btn ${classStr}" onclick="goToStep('${choice.next}')">${choice.text}${choice.sub ? `<span class="btn-sub">${choice.sub}</span>` : ''}</button>`;
                    }
                });
                html += `</div>`;
            }

            html += `</div>`;

            document.getElementById('mainContent').innerHTML = html;

            // ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ˜ãƒ«ãƒ—ã‚¨ãƒªã‚¢æ›´æ–°
            const floatingHelp = document.getElementById('floatingHelp');
            const floatingHelpButtons = document.getElementById('floatingHelpButtons');

            if (step.helps && step.helps.length > 0) {
                let helpHtml = '';
                step.helps.forEach(help => {
                    helpHtml += `<button class="help-btn" onclick="showHelp('${help.id}')">${help.label}</button>`;
                });
                floatingHelpButtons.innerHTML = helpHtml;
                floatingHelp.classList.add('visible');
            } else {
                floatingHelp.classList.remove('visible');
            }

            window.scrollTo(0, 0);
        }

        function goToStep(stepId) {
            history.push(currentStep);
            forwardHistory = []; // æ–°ã—ã„é¸æŠã‚’ã—ãŸã‚‰é€²ã‚€å±¥æ­´ã‚’ã‚¯ãƒªã‚¢
            renderStep(stepId);
        }

        function goBack() {
            if (history.length > 0) {
                forwardHistory.push(currentStep); // ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’é€²ã‚€å±¥æ­´ã«è¿½åŠ 
                const prevStep = history.pop();
                renderStep(prevStep);
            }
        }

        function goForward() {
            if (forwardHistory.length > 0) {
                history.push(currentStep); // ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’æˆ»ã‚‹å±¥æ­´ã«è¿½åŠ 
                const nextStep = forwardHistory.pop();
                renderStep(nextStep);
            }
        }

        function resetNavi() {
            history = [];
            forwardHistory = [];
            currentStep = 'step1';
            renderStep('step1');
        }

        function showHelp(helpId) {
            const step = STEPS[currentStep];
            let helpData = null;

            if (step.helps) {
                helpData = step.helps.find(h => h.id === helpId);
            }

            if (!helpData) {
                // ä»–ã®ã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰ã‚‚æ¤œç´¢
                for (const key in STEPS) {
                    const s = STEPS[key];
                    if (s.helps) {
                        const found = s.helps.find(h => h.id === helpId);
                        if (found) {
                            helpData = found;
                            break;
                        }
                    }
                }
            }

            if (helpData) {
                document.getElementById('modalTitle').textContent = helpData.title;
                document.getElementById('modalBody').innerHTML = helpData.content;
                document.getElementById('modalOverlay').classList.add('show');

                // step10ã®å ´åˆã€ã‚¢ãƒç²å¾—ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
                const actionBtn = document.getElementById('modalActionBtn');
                if (currentStep === 'step10') {
                    actionBtn.style.display = 'block';
                } else {
                    actionBtn.style.display = 'none';
                }
            }
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('show');
        }

        function closeModalAndProceed() {
            document.getElementById('modalOverlay').classList.remove('show');
            // step10ã‹ã‚‰endSuccessã¸é·ç§»
            if (currentStep === 'step10') {
                goToStep('endSuccess');
            }
        }

        function showPattern(num) {
            document.querySelectorAll('.pattern-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === num - 1);
            });
            document.querySelectorAll('.pattern-content').forEach((content, i) => {
                content.classList.toggle('active', i === num - 1);
            });
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.getElementById('backBtn').addEventListener('click', goBack);
        document.getElementById('forwardBtn').addEventListener('click', goForward);
        document.getElementById('resetBtn').addEventListener('click', () => {
            if (confirm('æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—ã¾ã™ã‹ï¼Ÿ')) {
                resetNavi();
            }
        });
        document.getElementById('modalClose').addEventListener('click', closeModal);
        document.getElementById('modalCloseBtn').addEventListener('click', closeModal);
        document.getElementById('modalActionBtn').addEventListener('click', closeModalAndProceed);
        document.getElementById('modalOverlay').addEventListener('click', (e) => {
            if (e.target === document.getElementById('modalOverlay')) {
                closeModal();
            }
        });

        // ========== ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿è­·ï¼ˆåˆæœŸåŒ–ï¼‰==========
        (function() {
            const CORRECT_PASSWORD = 'mix2025';
            const SESSION_KEY = 'sales_manual_auth';

            const loginScreen = document.getElementById('loginScreen');
            const appContent = document.getElementById('appContent');
            const passwordInput = document.getElementById('passwordInput');
            const loginBtn = document.getElementById('loginBtn');
            const loginError = document.getElementById('loginError');

            function checkSession() {
                return sessionStorage.getItem(SESSION_KEY) === 'authenticated';
            }

            function loginSuccess() {
                sessionStorage.setItem(SESSION_KEY, 'authenticated');
                loginScreen.classList.add('hidden');
                appContent.classList.add('visible');
                initNavi();
            }

            function loginFailed() {
                loginError.classList.add('show');
                passwordInput.classList.add('error');
                passwordInput.value = '';
                passwordInput.focus();
                setTimeout(() => passwordInput.classList.remove('error'), 400);
            }

            function verifyPassword() {
                if (passwordInput.value === CORRECT_PASSWORD) {
                    loginSuccess();
                } else {
                    loginFailed();
                }
            }

            if (checkSession()) {
                loginSuccess();
            } else {
                loginScreen.classList.remove('hidden');
            }

            loginBtn.addEventListener('click', verifyPassword);
            passwordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') verifyPassword();
            });
            passwordInput.addEventListener('input', () => {
                loginError.classList.remove('show');
            });
        })();

        // ========== æ¶é›»ãƒ­ã‚°æ©Ÿèƒ½ ==========
        const LOG_STORAGE_KEY = 'call_logs';
        const CALLERS_STORAGE_KEY = 'callers';
        const MAX_LOGS = 100;

        let callLogs = [];
        let callers = [];
        let currentCallData = null;
        let selectedLogIndex = null;

        // åˆæœŸåŒ–
        function initLogSystem() {
            loadCallers();
            loadLogs();
            updateLogBadge();
            document.getElementById('logBtn').style.display = 'block';
        }

        // æ¶é›»è€…ç®¡ç†
        function loadCallers() {
            const stored = localStorage.getItem(CALLERS_STORAGE_KEY);
            callers = stored ? JSON.parse(stored) : [];
            updateCallerDropdowns();
        }

        function saveCallers() {
            localStorage.setItem(CALLERS_STORAGE_KEY, JSON.stringify(callers));
        }

        function addCaller(name) {
            if (name && !callers.includes(name)) {
                callers.push(name);
                saveCallers();
                updateCallerDropdowns();
            }
        }

        function removeCaller(name) {
            callers = callers.filter(c => c !== name);
            saveCallers();
            updateCallerDropdowns();
        }

        function updateCallerDropdowns() {
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç”¨ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³
            const filterSelect = document.getElementById('logFilterCaller');
            filterSelect.innerHTML = '<option value="">å…¨ã¦ã®æ¶é›»è€…</option>';
            callers.forEach(c => {
                filterSelect.innerHTML += `<option value="${c}">${c}</option>`;
            });
        }

        // ãƒ­ã‚°ç®¡ç†
        function loadLogs() {
            const stored = localStorage.getItem(LOG_STORAGE_KEY);
            callLogs = stored ? JSON.parse(stored) : [];
        }

        function saveLogs() {
            // æœ€å¤§ä»¶æ•°ã‚’è¶…ãˆãŸã‚‰å¤ã„ã‚‚ã®ã‚’å‰Šé™¤
            while (callLogs.length > MAX_LOGS) {
                callLogs.shift();
            }
            localStorage.setItem(LOG_STORAGE_KEY, JSON.stringify(callLogs));
            updateLogBadge();
        }

        function updateLogBadge() {
            document.getElementById('logBadge').textContent = callLogs.length;
        }

        function addLog(logData) {
            logData.id = Date.now();
            logData.createdAt = new Date().toISOString();
            callLogs.push(logData);
            saveLogs();
        }

        function deleteLog(logId) {
            callLogs = callLogs.filter(log => log.id !== logId);
            saveLogs();
        }

        function deleteAllLogs() {
            if (confirm('ã™ã¹ã¦ã®ãƒ­ã‚°ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                callLogs = [];
                saveLogs();
                renderLogList();
            }
        }

        // æ¶é›»é–‹å§‹ãƒ•ã‚©ãƒ¼ãƒ ã‚’ç”Ÿæˆ
        function generateCallStartForm() {
            return `
                <div class="call-start-form" id="callStartForm">
                    <h3>ğŸ“ æ¶é›»æƒ…å ±ã‚’å…¥åŠ›</h3>
                    <div class="form-row">
                        <label class="form-label">æ¶é›»è€…å<span class="required">*</span></label>
                        <div class="form-row-inline">
                            <select class="form-input" id="callerSelect">
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                ${callers.map(c => `<option value="${c}">${c}</option>`).join('')}
                                <option value="__new__">+ æ–°è¦è¿½åŠ </option>
                            </select>
                        </div>
                        <div id="newCallerInput" style="display: none; margin-top: 0.5rem;">
                            <div class="form-row-inline">
                                <input type="text" class="form-input" id="newCallerName" placeholder="æ–°ã—ã„æ¶é›»è€…å">
                                <button class="form-btn-small add" onclick="addNewCaller()">è¿½åŠ </button>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <label class="form-label">ä¼šç¤¾å<span class="required">*</span></label>
                        <input type="text" class="form-input" id="companyName" placeholder="ä¾‹ï¼šæ ªå¼ä¼šç¤¾â—‹â—‹">
                    </div>
                    <div class="form-row">
                        <label class="form-label">é›»è©±ç•ªå·</label>
                        <input type="tel" class="form-input" id="phoneNumber" placeholder="ä¾‹ï¼š06-1234-5678">
                    </div>
                </div>
            `;
        }

        // æ¶é›»è€…é¸æŠå¤‰æ›´æ™‚
        function onCallerSelectChange() {
            const select = document.getElementById('callerSelect');
            const newInput = document.getElementById('newCallerInput');
            if (select && newInput) {
                newInput.style.display = select.value === '__new__' ? 'block' : 'none';
            }
        }

        // æ–°è¦æ¶é›»è€…è¿½åŠ 
        function addNewCaller() {
            const input = document.getElementById('newCallerName');
            if (input && input.value.trim()) {
                addCaller(input.value.trim());
                const select = document.getElementById('callerSelect');
                select.innerHTML = `
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    ${callers.map(c => `<option value="${c}">${c}</option>`).join('')}
                    <option value="__new__">+ æ–°è¦è¿½åŠ </option>
                `;
                select.value = input.value.trim();
                document.getElementById('newCallerInput').style.display = 'none';
                input.value = '';
            }
        }

        // ç¾åœ¨ã®æ¶é›»ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
        function getCurrentCallData() {
            const callerSelect = document.getElementById('callerSelect');
            const companyName = document.getElementById('companyName');
            const phoneNumber = document.getElementById('phoneNumber');

            if (!callerSelect || !companyName) return null;

            return {
                caller: callerSelect.value === '__new__' ? '' : callerSelect.value,
                company: companyName.value.trim(),
                phone: phoneNumber ? phoneNumber.value.trim() : ''
            };
        }

        // ã‚¢ãƒç²å¾—ç”¨è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ 
        function generateSuccessForm() {
            return `
                <div class="call-start-form" style="margin-top: 1rem;">
                    <h3>ğŸ“ ã‚¢ãƒæƒ…å ±ã‚’å…¥åŠ›</h3>
                    <div class="form-row">
                        <label class="form-label">æ‹…å½“è€…å<span class="required">*</span></label>
                        <input type="text" class="form-input" id="contactName" placeholder="ä¾‹ï¼šå±±ç”°å¤ªéƒ">
                    </div>
                    <div class="form-row">
                        <label class="form-label">æºå¸¯ç•ªå·ï¼ˆä»»æ„ï¼‰</label>
                        <input type="tel" class="form-input" id="mobileNumber" placeholder="ä¾‹ï¼š090-1234-5678">
                    </div>
                    <div class="form-row">
                        <label class="form-label">æ¡ˆå†…å†…å®¹</label>
                        <div class="form-checkbox-group">
                            <label class="form-checkbox-label">
                                <input type="checkbox" id="serviceElectric"> é›»æ°—
                            </label>
                            <label class="form-checkbox-label">
                                <input type="checkbox" id="serviceNet"> ãƒãƒƒãƒˆ
                            </label>
                            <label class="form-checkbox-label">
                                <input type="checkbox" id="servicePhone"> é›»è©±å›ç·š
                            </label>
                        </div>
                    </div>
                    <div class="form-row">
                        <label class="form-label">æ˜ç´°ç¨®é¡</label>
                        <div class="form-checkbox-group">
                            <label class="form-checkbox-label">
                                <input type="radio" name="receiptType" value="paper"> ç´™æ˜ç´°
                            </label>
                            <label class="form-checkbox-label">
                                <input type="radio" name="receiptType" value="web"> WEBæ˜ç´°
                            </label>
                        </div>
                    </div>
                    <div class="form-row">
                        <label class="form-label">æ’®å½±å¸Œæœ›</label>
                        <div class="form-checkbox-group">
                            <label class="form-checkbox-label">
                                <input type="radio" name="photoWanted" value="yes"> ã‚ã‚Š
                            </label>
                            <label class="form-checkbox-label">
                                <input type="radio" name="photoWanted" value="no"> ãªã—ï¼ˆCBæ¡ˆå†…ï¼‰
                            </label>
                        </div>
                    </div>
                    <div class="form-row">
                        <label class="form-label">ãƒ¡ãƒ¢</label>
                        <textarea class="form-input" id="successMemo" rows="3" placeholder="å‚™è€ƒãŒã‚ã‚Œã°å…¥åŠ›"></textarea>
                    </div>
                    <button class="choice-btn success" onclick="saveSuccessLog()" style="width: 100%; margin-top: 1rem;">
                        ğŸ’¾ ãƒ­ã‚°ã‚’ä¿å­˜ã—ã¦å®Œäº†
                    </button>
                </div>
            `;
        }

        // å†æ¶é›»ãƒ»å¯¾è±¡å¤–ç”¨ãƒ•ã‚©ãƒ¼ãƒ 
        function generateEndForm(endType) {
            const isRecall = endType === 'recall' || endType === 'recallScheduled';
            return `
                <div class="call-start-form" style="margin-top: 1rem;">
                    <h3>ğŸ“ çµ‚äº†æƒ…å ±ã‚’å…¥åŠ›</h3>
                    <div class="form-row">
                        <label class="form-label">çµ‚äº†ç†ç”±</label>
                        <select class="form-input" id="endReason">
                            <option value="ä¸åœ¨">ä¸åœ¨</option>
                            <option value="å¯¾è±¡å¤–">å¯¾è±¡å¤–</option>
                            <option value="æ‹’å¦">æ‹’å¦</option>
                            <option value="ãã®ä»–">ãã®ä»–</option>
                        </select>
                    </div>
                    ${isRecall ? `
                    <div class="form-row">
                        <label class="form-label">å†æ¶é›»äºˆå®šæ—¥æ™‚</label>
                        <input type="datetime-local" class="form-input" id="recallDateTime">
                    </div>
                    ` : ''}
                    <div class="form-row">
                        <label class="form-label">ãƒ¡ãƒ¢</label>
                        <textarea class="form-input" id="endMemo" rows="3" placeholder="å‚™è€ƒãŒã‚ã‚Œã°å…¥åŠ›"></textarea>
                    </div>
                    <button class="choice-btn primary" onclick="saveEndLog('${endType}')" style="width: 100%; margin-top: 1rem;">
                        ğŸ’¾ ãƒ­ã‚°ã‚’ä¿å­˜
                    </button>
                </div>
            `;
        }

        // ã‚¢ãƒç²å¾—ãƒ­ã‚°ã‚’ä¿å­˜
        function saveSuccessLog() {
            const callData = getCurrentCallData();
            if (!callData || !callData.caller || !callData.company) {
                alert('æ¶é›»è€…åã¨ä¼šç¤¾åã¯å¿…é ˆã§ã™');
                return;
            }

            const contactName = document.getElementById('contactName');
            const mobileNumber = document.getElementById('mobileNumber');
            const successMemo = document.getElementById('successMemo');

            const services = [];
            if (document.getElementById('serviceElectric')?.checked) services.push('é›»æ°—');
            if (document.getElementById('serviceNet')?.checked) services.push('ãƒãƒƒãƒˆ');
            if (document.getElementById('servicePhone')?.checked) services.push('é›»è©±å›ç·š');

            const receiptType = document.querySelector('input[name="receiptType"]:checked')?.value || '';
            const photoWanted = document.querySelector('input[name="photoWanted"]:checked')?.value || '';

            const log = {
                ...callData,
                result: 'success',
                resultLabel: 'ã‚¢ãƒç²å¾—',
                contactName: contactName?.value.trim() || '',
                mobile: mobileNumber?.value.trim() || '',
                services: services,
                receiptType: receiptType,
                photoWanted: photoWanted,
                memo: successMemo?.value.trim() || ''
            };

            addLog(log);
            alert('ãƒ­ã‚°ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
        }

        // çµ‚äº†ãƒ­ã‚°ã‚’ä¿å­˜
        function saveEndLog(endType) {
            const callData = getCurrentCallData();
            if (!callData || !callData.caller || !callData.company) {
                alert('æ¶é›»è€…åã¨ä¼šç¤¾åã¯å¿…é ˆã§ã™');
                return;
            }

            const endReason = document.getElementById('endReason');
            const recallDateTime = document.getElementById('recallDateTime');
            const endMemo = document.getElementById('endMemo');

            const resultMap = {
                'recall': { result: 'recall', label: 'å†æ¶é›»' },
                'recallScheduled': { result: 'recall', label: 'å†æ¶é›»äºˆç´„' },
                'notTarget': { result: 'not-target', label: 'å¯¾è±¡å¤–' }
            };

            const resultInfo = resultMap[endType] || { result: 'not-target', label: 'å¯¾è±¡å¤–' };

            const log = {
                ...callData,
                result: resultInfo.result,
                resultLabel: resultInfo.label,
                endReason: endReason?.value || '',
                recallDateTime: recallDateTime?.value || '',
                memo: endMemo?.value.trim() || ''
            };

            addLog(log);
            alert('ãƒ­ã‚°ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
        }

        // ãƒ­ã‚°ä¸€è¦§è¡¨ç¤º
        function showLogList() {
            renderLogList();
            document.getElementById('logListModal').classList.add('show');
        }

        function hideLogList() {
            document.getElementById('logListModal').classList.remove('show');
        }

        function renderLogList() {
            const filterCaller = document.getElementById('logFilterCaller').value;
            const filterResult = document.getElementById('logFilterResult').value;

            let filteredLogs = [...callLogs].reverse();

            if (filterCaller) {
                filteredLogs = filteredLogs.filter(log => log.caller === filterCaller);
            }
            if (filterResult) {
                filteredLogs = filteredLogs.filter(log => log.result === filterResult);
            }

            const body = document.getElementById('logListBody');

            if (filteredLogs.length === 0) {
                body.innerHTML = `
                    <div class="empty-logs">
                        <div class="icon">ğŸ“­</div>
                        <p>ãƒ­ã‚°ãŒã‚ã‚Šã¾ã›ã‚“</p>
                    </div>
                `;
                return;
            }

            body.innerHTML = filteredLogs.map((log, index) => {
                const date = new Date(log.createdAt);
                const dateStr = `${date.getMonth() + 1}/${date.getDate()} ${date.getHours()}:${String(date.getMinutes()).padStart(2, '0')}`;

                return `
                    <div class="log-item" onclick="showLogDetail(${log.id})">
                        <div class="log-item-header">
                            <span class="log-item-date">${dateStr}</span>
                            <span class="log-item-result ${log.result}">${log.resultLabel}</span>
                        </div>
                        <div class="log-item-company">${log.company}</div>
                        <div class="log-item-caller">æ¶é›»è€…ï¼š${log.caller}</div>
                    </div>
                `;
            }).join('');
        }

        // ãƒ­ã‚°è©³ç´°è¡¨ç¤º
        function showLogDetail(logId) {
            const log = callLogs.find(l => l.id === logId);
            if (!log) return;

            selectedLogIndex = logId;

            const date = new Date(log.createdAt);
            const dateStr = `${date.getFullYear()}/${date.getMonth() + 1}/${date.getDate()} ${date.getHours()}:${String(date.getMinutes()).padStart(2, '0')}`;

            let detailHtml = `
                <div class="log-detail-section">
                    <h4>åŸºæœ¬æƒ…å ±</h4>
                    <div class="log-detail-row">
                        <span class="label">æ¶é›»æ—¥æ™‚</span>
                        <span class="value">${dateStr}</span>
                    </div>
                    <div class="log-detail-row">
                        <span class="label">æ¶é›»è€…</span>
                        <span class="value">${log.caller}</span>
                    </div>
                    <div class="log-detail-row">
                        <span class="label">ä¼šç¤¾å</span>
                        <span class="value">${log.company}</span>
                    </div>
                    <div class="log-detail-row">
                        <span class="label">é›»è©±ç•ªå·</span>
                        <span class="value">${log.phone || '-'}</span>
                    </div>
                    <div class="log-detail-row">
                        <span class="label">çµæœ</span>
                        <span class="value">${log.resultLabel}</span>
                    </div>
                </div>
            `;

            if (log.result === 'success') {
                detailHtml += `
                    <div class="log-detail-section">
                        <h4>ã‚¢ãƒæƒ…å ±</h4>
                        <div class="log-detail-row">
                            <span class="label">æ‹…å½“è€…å</span>
                            <span class="value">${log.contactName || '-'}</span>
                        </div>
                        <div class="log-detail-row">
                            <span class="label">æºå¸¯ç•ªå·</span>
                            <span class="value">${log.mobile || '-'}</span>
                        </div>
                        <div class="log-detail-row">
                            <span class="label">æ¡ˆå†…å†…å®¹</span>
                            <span class="value">${log.services?.join(', ') || '-'}</span>
                        </div>
                        <div class="log-detail-row">
                            <span class="label">æ˜ç´°ç¨®é¡</span>
                            <span class="value">${log.receiptType === 'paper' ? 'ç´™æ˜ç´°' : log.receiptType === 'web' ? 'WEBæ˜ç´°' : '-'}</span>
                        </div>
                        <div class="log-detail-row">
                            <span class="label">æ’®å½±å¸Œæœ›</span>
                            <span class="value">${log.photoWanted === 'yes' ? 'ã‚ã‚Š' : log.photoWanted === 'no' ? 'ãªã—' : '-'}</span>
                        </div>
                    </div>
                `;
            } else {
                detailHtml += `
                    <div class="log-detail-section">
                        <h4>çµ‚äº†æƒ…å ±</h4>
                        <div class="log-detail-row">
                            <span class="label">çµ‚äº†ç†ç”±</span>
                            <span class="value">${log.endReason || '-'}</span>
                        </div>
                        ${log.recallDateTime ? `
                        <div class="log-detail-row">
                            <span class="label">å†æ¶é›»äºˆå®š</span>
                            <span class="value">${log.recallDateTime.replace('T', ' ')}</span>
                        </div>
                        ` : ''}
                    </div>
                `;
            }

            if (log.memo) {
                detailHtml += `
                    <div class="log-detail-section">
                        <h4>ãƒ¡ãƒ¢</h4>
                        <div class="log-detail-memo">${log.memo}</div>
                    </div>
                `;
            }

            detailHtml += `
                <div class="log-detail-actions">
                    <button class="log-detail-btn image" onclick="downloadLogImage(${log.id})">ğŸ“· ç”»åƒä¿å­˜</button>
                    <button class="log-detail-btn delete" onclick="deleteLogConfirm(${log.id})">ğŸ—‘ï¸ å‰Šé™¤</button>
                </div>
            `;

            document.getElementById('logDetailContent').innerHTML = detailHtml;
            document.getElementById('logDetailModal').classList.add('show');
        }

        function hideLogDetail() {
            document.getElementById('logDetailModal').classList.remove('show');
        }

        function deleteLogConfirm(logId) {
            if (confirm('ã“ã®ãƒ­ã‚°ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                deleteLog(logId);
                hideLogDetail();
                renderLogList();
            }
        }

        // CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        function downloadCsv() {
            if (callLogs.length === 0) {
                alert('ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãƒ­ã‚°ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }

            const headers = ['æ—¥æ™‚', 'æ¶é›»è€…', 'ä¼šç¤¾å', 'é›»è©±ç•ªå·', 'çµæœ', 'æ‹…å½“è€…å', 'æºå¸¯ç•ªå·', 'æ¡ˆå†…å†…å®¹', 'æ˜ç´°ç¨®é¡', 'æ’®å½±å¸Œæœ›', 'çµ‚äº†ç†ç”±', 'å†æ¶é›»äºˆå®š', 'ãƒ¡ãƒ¢'];

            const rows = callLogs.map(log => {
                const date = new Date(log.createdAt);
                const dateStr = `${date.getFullYear()}/${date.getMonth() + 1}/${date.getDate()} ${date.getHours()}:${String(date.getMinutes()).padStart(2, '0')}`;

                return [
                    dateStr,
                    log.caller || '',
                    log.company || '',
                    log.phone || '',
                    log.resultLabel || '',
                    log.contactName || '',
                    log.mobile || '',
                    log.services?.join('/') || '',
                    log.receiptType === 'paper' ? 'ç´™' : log.receiptType === 'web' ? 'WEB' : '',
                    log.photoWanted === 'yes' ? 'ã‚ã‚Š' : log.photoWanted === 'no' ? 'ãªã—' : '',
                    log.endReason || '',
                    log.recallDateTime ? log.recallDateTime.replace('T', ' ') : '',
                    log.memo || ''
                ].map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(',');
            });

            const csvContent = '\uFEFF' + headers.join(',') + '\n' + rows.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });

            const today = new Date();
            const fileName = `æ¶é›»ãƒ­ã‚°_${today.getFullYear()}${String(today.getMonth() + 1).padStart(2, '0')}${String(today.getDate()).padStart(2, '0')}.csv`;

            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = fileName;
            link.click();
        }

        // ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        async function downloadLogImage(logId) {
            const log = callLogs.find(l => l.id === logId);
            if (!log) return;

            const date = new Date(log.createdAt);
            const dateStr = `${date.getFullYear()}/${date.getMonth() + 1}/${date.getDate()} ${date.getHours()}:${String(date.getMinutes()).padStart(2, '0')}`;

            document.getElementById('captureDate').textContent = dateStr;

            let bodyHtml = `
                <div class="log-capture-row"><span>æ¶é›»è€…</span><span>${log.caller}</span></div>
                <div class="log-capture-row"><span>ä¼šç¤¾å</span><span>${log.company}</span></div>
                <div class="log-capture-row"><span>é›»è©±ç•ªå·</span><span>${log.phone || '-'}</span></div>
                <div class="log-capture-row"><span>çµæœ</span><span>${log.resultLabel}</span></div>
            `;

            if (log.result === 'success') {
                bodyHtml += `
                    <div class="log-capture-row"><span>æ‹…å½“è€…å</span><span>${log.contactName || '-'}</span></div>
                    <div class="log-capture-row"><span>æºå¸¯ç•ªå·</span><span>${log.mobile || '-'}</span></div>
                    <div class="log-capture-row"><span>æ¡ˆå†…å†…å®¹</span><span>${log.services?.join(', ') || '-'}</span></div>
                    <div class="log-capture-row"><span>æ˜ç´°ç¨®é¡</span><span>${log.receiptType === 'paper' ? 'ç´™æ˜ç´°' : log.receiptType === 'web' ? 'WEBæ˜ç´°' : '-'}</span></div>
                    <div class="log-capture-row"><span>æ’®å½±å¸Œæœ›</span><span>${log.photoWanted === 'yes' ? 'ã‚ã‚Š' : log.photoWanted === 'no' ? 'ãªã—' : '-'}</span></div>
                `;
            } else {
                bodyHtml += `
                    <div class="log-capture-row"><span>çµ‚äº†ç†ç”±</span><span>${log.endReason || '-'}</span></div>
                `;
                if (log.recallDateTime) {
                    bodyHtml += `<div class="log-capture-row"><span>å†æ¶é›»äºˆå®š</span><span>${log.recallDateTime.replace('T', ' ')}</span></div>`;
                }
            }

            if (log.memo) {
                bodyHtml += `<div class="log-capture-row" style="flex-direction: column; align-items: flex-start;"><span style="margin-bottom: 0.25rem;">ãƒ¡ãƒ¢</span><span style="white-space: pre-wrap;">${log.memo}</span></div>`;
            }

            document.getElementById('captureBody').innerHTML = bodyHtml;

            // Move capture area into view for rendering
            const captureEl = document.getElementById('logCapture');
            captureEl.style.left = '0';

            try {
                const canvas = await html2canvas(captureEl, {
                    backgroundColor: '#ffffff',
                    scale: 2
                });

                captureEl.style.left = '-9999px';

                const link = document.createElement('a');
                link.download = `æ¶é›»è¨˜éŒ²_${log.company}_${date.getMonth() + 1}${date.getDate()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            } catch (err) {
                captureEl.style.left = '-9999px';
                alert('ç”»åƒã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
                console.error(err);
            }
        }

        // renderStepã‚’æ‹¡å¼µã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¿½åŠ 
        const originalRenderStep = renderStep;
        renderStep = function(stepId) {
            originalRenderStep(stepId);

            const step = STEPS[stepId];
            if (!step) return;

            const mainContent = document.getElementById('mainContent');

            // step1ã®å ´åˆã€æ¶é›»é–‹å§‹ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¿½åŠ 
            if (stepId === 'step1') {
                mainContent.innerHTML = generateCallStartForm() + mainContent.innerHTML;
                // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
                setTimeout(() => {
                    const select = document.getElementById('callerSelect');
                    if (select) {
                        select.addEventListener('change', onCallerSelectChange);
                    }
                }, 0);
            }

            // çµ‚äº†ç”»é¢ã®å ´åˆã€é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ ã‚’è¿½åŠ 
            if (step.isEnd) {
                if (step.endType === 'success') {
                    mainContent.innerHTML += generateSuccessForm();
                } else if (step.endType === 'recall' || step.endType === 'recallScheduled' || step.endType === 'notTarget') {
                    mainContent.innerHTML += generateEndForm(step.endType);
                }
            }
        };

        // ãƒ­ã‚°é–¢é€£ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.getElementById('logBtn').addEventListener('click', showLogList);
        document.getElementById('logListClose').addEventListener('click', hideLogList);
        document.getElementById('logDetailClose').addEventListener('click', hideLogDetail);
        document.getElementById('logDownloadCsv').addEventListener('click', downloadCsv);
        document.getElementById('logDeleteAll').addEventListener('click', deleteAllLogs);
        document.getElementById('logFilterCaller').addEventListener('change', renderLogList);
        document.getElementById('logFilterResult').addEventListener('change', renderLogList);

        document.getElementById('logListModal').addEventListener('click', (e) => {
            if (e.target.id === 'logListModal') hideLogList();
        });
        document.getElementById('logDetailModal').addEventListener('click', (e) => {
            if (e.target.id === 'logDetailModal') hideLogDetail();
        });

        // ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
        initLogSystem();
    </script>
</body>
</html>
